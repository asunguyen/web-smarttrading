"use strict";(self.webpackChunktradingview=self.webpackChunktradingview||[]).push([[71175],{972898:(e,t,s)=>{s.r(t),s.d(t,{ChartLottieAnimation:()=>U});var r=s(12481),i=s(650151),n=s(49437);let a=0;class o{constructor(e){this.paused=!1,this.frame=-1,this.totalFrames=-1,this.frameRate=60,this.disposed=!1,this._listeners={};const{canvas:t}=e,s=e.width||t.width,r=e.height||t.height,i=t.getContext("2d",{alpha:!0,willReadFrequently:!0});if(this.canvas=t,!i)throw new Error("Cannot create canvas context");this.ctx=i,this.id=e.id||"__lottie"+a++,this.dpr=e.dpr||window.devicePixelRatio||1,this.loop=e.loop||!1,e.fps&&(this.frameRate=e.fps),e.fill&&(this.fill=e.fill),this.resize(s,r)}width(){var e;return(null===(e=this.canvas)||void 0===e?void 0:e.width)||0}height(){var e;return(null===(e=this.canvas)||void 0===e?void 0:e.height)||0}mounted(){return-1!==this.totalFrames}frameTime(){return 1e3/this.frameRate}lastFrame(){return this.totalFrames-1}play(){let e=!1;this.paused&&(this.paused=!1,e=!0),this.loop&&this.frame===this.lastFrame()&&(this.frame=0,e=!0),e&&this.emit("play")}pause(){this.paused||(this.paused=!0,this.emit("pause"))}toggle(){this.paused?this.play():this.pause()}resize(e,t,s=this.dpr){const{canvas:r}=this;r&&(this.dpr=s,r.width=e*s,r.height=t*s,r.style.width=`${e}px`,r.style.height=`${t}px`,this.mounted()&&this.emit("resize",e,t,s))}mount(e){this.mounted()||(this.totalFrames=e.totalFrames,this.frameRate=e.frameRate||60,this.emit("mount",this.totalFrames,e.frameRate))}dispose(){this.disposed=!0,this.frame=this.totalFrames=-1,this.emit("dispose"),this._listeners={}}on(e,t){const s=this._listeners[e];return s?s.includes(t)||s.push(t):this._listeners[e]=[t],this}off(e,t){const s=this._listeners[e];if(s){const r=[];for(let e=0;e<s.length;e++)s[e]!==t&&r.push(s[e]);this._listeners[e]=r}return this}emit(e,...t){const s=this._listeners[e];if(s)for(let e=0;e<s.length;e++)s[e].apply(this,t);return this}}function h(){let e=()=>{},t=()=>{};return{promise:new Promise(((s,r)=>{e=s,t=r})),resolve:e,reject:t}}async function l(e){if("string"==typeof e){if(/^(https?|data|file):/.test(e)){const t=await fetch(e,{mode:"cors"});if(t.ok)return t.text();throw new Error(`Invalid response: ${t.status}: ${t.statusText}`)}return e}return JSON.stringify(e)}const c={maxWorkers:4,playersPerWorker:5,getWorker:async()=>{throw new Error("Missing worker, define getWorker in config")},cacheFrames:!1};function d(){return c}const m=[];let f=1;class u{constructor(){this.refs=0,this._deferred=h(),this._seq=0,this._requests=new Map,this.onMessage=e=>{if("seq"in e.data){const{seq:t,payload:s}=e.data,r=this._requests.get(t);r&&(this._requests.delete(t),r.resolve(s))}},this.id=f++}get promise(){return this._deferred.promise}send(e,t){this._seq=(this._seq+1)%1e6;const s=this._seq,r={name:e,payload:t,seq:s},i=h();return this._worker?(this._requests.set(s,i),this._worker.postMessage(r)):i.reject(new Error("Worker is not mounted")),i.promise}attach(e){this._worker=e,this._worker.addEventListener("message",this.onMessage),this._deferred.resolve(this)}fail(e){
this._deferred.reject(e)}dispose(){this._requests.size&&(this._requests.forEach((e=>e.reject(w()))),this._requests.clear()),this._worker?(this._worker.removeEventListener("message",this.onMessage),this._worker.terminate(),this._worker=void 0):this.fail(w())}}function p(){const e=d();let t,s;for(let r=0;r<m.length;r++){const i=m[r];if(i.refs<e.playersPerWorker){t=i;break}(!s||s.refs>i.refs)&&(s=i)}return!t&&s&&m.length>=e.maxWorkers&&(t=s),t||(t=new u,m.push(t),async function(e){const t=await d().getWorker(),s=()=>{t.removeEventListener("message",r),t.removeEventListener("error",i)},r=r=>{"init"===r.data.type&&(s(),m.includes(e)?e.attach(t):(t.terminate(),e.fail(w())))},i=t=>{s(),e.fail(new Error(t.error||t.message))};t.addEventListener("message",r),t.addEventListener("error",i)}(t)),t.refs++,t.promise}function g(e){if(e.refs--,e.refs<=0){e.dispose();const t=m.indexOf(e);-1!==t&&m.splice(t,1)}}function w(){return new Error("ETERMINATE")}const y=new Map;let _=!1,v=0,b=0,k=-1;!function(){try{if("object"==typeof WebAssembly&&"function"==typeof WebAssembly.instantiate){const e=new WebAssembly.Module(Uint8Array.of(0,97,115,109,1,0,0,0));if(e instanceof WebAssembly.Module)return new WebAssembly.Instance(e)instanceof WebAssembly.Instance}}catch(e){}}();const C=document.createElement("canvas");function E(e){const t=new o(e);return function(e,t){const{id:s}=e;let r=y.get(s);r?(r.players.push(e),F(s),r.worker&&(e.mount(r),W())):(r={id:s,frame:0,totalFrames:-1,frameRate:60,start:0,players:[e]},y.set(s,r),Promise.all([p(),l(t)]).then((([e,t])=>{e.send("create",{id:s,data:t}).then((t=>{y.get(s)===r&&r?(r.worker=e,r.totalFrames=t.totalFrames,t.frameRate&&(r.frameRate=t.frameRate),r.players.forEach((e=>e.mount(t))),W()):g(e)}))})))}(t,e.movie),t.on("play",(()=>W())).on("dispose",(()=>function(e){const{id:t}=e,s=y.get(t);s&&(s.players=s.players.filter((t=>t!==e)),s.players.length||(y.delete(t),s.worker&&g(s.worker)))}(t))).on("resize",(()=>F(t.id))),t}function F(e){const t=y.get(e);t&&t.players.length>1&&t.players.sort(((e,t)=>t.width()-e.width()))}function R(e){return!e.paused&&(e.loop||e.frame<e.totalFrames-1)}function W(){v||_||(v=requestAnimationFrame(x))}function x(e){let t=!1;k=d().maxRender||-1;const s={frameTime:0,paintTime:0,tickDelta:b?e-b:0},r=new Map;if(y.forEach((i=>{const{worker:n,players:a}=i,o=n&&a.find(R);if(o){t=!0,i.start||(i.start=e-i.frame%o.lastFrame()*o.frameTime());const a=function(e,t){let s=Math.floor(t/e.frameTime());return s=e.loop?s%e.lastFrame():Math.min(s,e.lastFrame()),{id:e.id,width:e.width(),height:e.height(),frame:s}}(o,e-i.start),h=function(e){const t=y.get(e.id);if(null==t?void 0:t.frameCache){const s=t.frameCache[e.frame];if(s&&s.width>=e.width&&s.height>=e.height)return s}return}(a);if(h)s.paintTime+=I(a.id,a.frame,h);else if(function(e,t){const s=y.get(e);if(s)return s.players.some((e=>P(e,t)));return!1}(a.id,a.frame)){const e=r.get(n);e?e.push(a):r.set(n,[a])}i.frame=a.frame}else i.start=0})),b=e,r.size){const e=performance.now(),t=[];r.forEach(((e,s)=>{const r=s.send("render",{frames:e
}).catch((()=>({frames:[]})));t.push(r)})),Promise.all(t).then((t=>{s.frameTime=performance.now()-e,t.forEach((e=>{e.frames.forEach((e=>{s.paintTime+=function(e){const t=performance.now(),{id:s}=e;if(y.has(s)){const t=new Uint8ClampedArray(e.data),r=new ImageData(t,e.width,e.height);d().cacheFrames&&function(e,t,s){const r=y.get(e);r&&-1!==r.totalFrames&&(r.frameCache||(r.frameCache=new Array(r.totalFrames)),r.frameCache[t]=s)}(s,e.frame,r),I(s,e.frame,r)}return performance.now()-t}(e)}))})),q(s),A()})).catch((()=>A()))}else q(s),A(t)}function A(e){v=0,!1!==e?W():b=0}function I(e,t,s){const r=performance.now(),i=y.get(e);let n;if(i){const{players:e}=i;for(let r=0;r<e.length;r++){const i=e[r];R(i)&&P(i,t)&&(S(i,t,s,n),n=i.canvas)}}return performance.now()-r}function S(e,t,s,r){const i=-1===e.frame,{ctx:n,canvas:a,fill:o}=e,{width:h,height:l}=a;if(-1===k||k>0||i){if(s.width!==h||s.height!==l||o){if(!r){C.width=s.width,C.height=s.height;const e=C.getContext("2d");if(!e)throw new Error("Cannot create canvas context");e.putImageData(s,0,0),r=C}o?(n.save(),n.fillStyle=o,n.fillRect(0,0,n.canvas.width,n.canvas.height),n.globalCompositeOperation="destination-in",n.drawImage(r,0,0,h,l),n.restore()):(n.clearRect(0,0,h,l),n.drawImage(r,0,0,h,l))}else n.putImageData(s,0,0);k>0&&k--}e.frame=t,i&&e.emit("rendered"),function(e){return!e.loop&&e.frame===e.lastFrame()}(e)&&(e.pause(),e.emit("end"))}function P(e,t){return-1!==e.totalFrames&&e.frame!==t}function q(e){const{stats:t}=d();t&&t(e)}var T=s(930003);class M{constructor(){var e;this._player=null,e={getWorker:async()=>new T.Worker(new URL(s.p+s.u(80166),s.b),{name:"Lottie Player Worker",type:void 0})},Object.assign(c,e),this._clearPlayerCallback=this._clearPlayer.bind(this)}show(e){this._disposeCurrentPlayerIfNeeded(),this._player=E(e),this._player.on("end",this._clearPlayerCallback)}destroy(){this._clearPlayer()}_clearPlayer(){this._disposeCurrentPlayerIfNeeded(),this._player=null}_disposeCurrentPlayerIfNeeded(){null!==this._player&&(this._player.off("end",this._clearPlayerCallback),this._player.dispose())}}const L={animationUrl:s(786927),width:200,height:250,id:"DOGEUSD_gr",keepOriginalSize:!0},O={animationUrl:s(535605),width:200,height:1e3,id:"SHITUSDD"};const D="symbolChangedAnimation";const N={};class U{constructor(e,t){this._canvas=null,this._animationRunner=null,this._chartWidgetCollection=e,this._currentSymbol=t.spawn(),this._currentSymbol.subscribe((0,r.default)((e=>this._showAnimationOnSymbolChange(e)),1e3))}destroy(){this._currentSymbol.destroy(),this._stopAnimation()}_showAnimationOnSymbolChange(e){var t,s,r;this._stopAnimation();const a=function(e){return e.startsWith("DOGEUSD")?L:e.startsWith("SHITUSD")?O:null}(null!==(t=e.split(":")[1])&&void 0!==t?t:e);if(null===a)return;const o=a.id,h=JSON.parse(null!==(s=n.TVLocalStorage.getItem(D))&&void 0!==s?s:"{}");if(N[o]=(null!==(r=N[o])&&void 0!==r?r:0)+1,h[o]&&10!==N[o])return;this._createCanvasIfNeed(),this._animationRunner=new M;const l=(0,i.ensureNotNull)(this._canvas);let c,d;var m;a.keepOriginalSize?(c=a.height,
d=a.width):(c=window.innerHeight-parseInt(l.style.bottom),d=Math.round(c/a.height*a.width)),this._animationRunner.show({canvas:l,movie:(m=a.animationUrl,new URL(m,location.origin).href),width:d,height:c}),h[o]=!0,n.TVLocalStorage.setItem(D,JSON.stringify(h))}_createCanvasIfNeed(){if(null!==this._canvas)return;const e=this._chartWidgetCollection.getAll(),t=e[e.length-1],s=t.paneWidgets(),r=t.timeAxisHeight(),i=s[s.length-1].rightPriceAxisesContainer().getElement().getBoundingClientRect();this._canvas=document.createElement("canvas"),this._canvas.style.position="absolute",this._canvas.style.zIndex="10000",this._canvas.style.bottom=window.innerHeight-i.bottom-r+"px",this._canvas.style.right=window.innerWidth-i.left+"px",this._canvas.style.pointerEvents="none",document.body.appendChild(this._canvas)}_stopAnimation(){var e,t;null===(e=this._animationRunner)||void 0===e||e.destroy(),null===(t=this._canvas)||void 0===t||t.remove(),this._canvas=null}}},786927:(e,t,s)=>{e.exports=s.p+"doge.92aa2ddd672ad01540de.json"},535605:(e,t,s)=>{e.exports=s.p+"poop.d5ceaf757b8cd319f89e.json"}}]);