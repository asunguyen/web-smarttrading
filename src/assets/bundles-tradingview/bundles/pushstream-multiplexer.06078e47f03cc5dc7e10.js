"use strict";(self.webpackChunktradingview=self.webpackChunktradingview||[]).push([[34604],{650151:(e,t)=>{function n(e,t){if(void 0===e)throw new Error("".concat(null!=t?t:"Value"," is undefined"));return e}function r(e,t){if(null===e)throw new Error("".concat(null!=t?t:"Value"," is null"));return e}Object.defineProperty(t,"__esModule",{value:!0}),t.ensureNever=t.ensure=t.ensureNotNull=t.ensureDefined=t.assert=void 0,t.assert=function(e,t){if(!e)throw new Error("Assertion failed".concat(t?": ".concat(t):""))},t.ensureDefined=n,t.ensureNotNull=r,t.ensure=function(e,t){return r(n(e,t),t)},t.ensureNever=function(e){}},251954:(e,t,n)=>{n.r(t),n.d(t,{emit:()=>h,emitOnce:()=>d,on:()=>l,subscribe:()=>c,subscribeToAll:()=>u,unsubscribe:()=>a});var r=n(707957);const o={},s=[],i={};function a(e,t,n){o[e].unsubscribe(n,t)}function l(e,t,n){c(e,t,n)}function c(e,t,n,s){o.hasOwnProperty(e)||(o[e]=new r.Delegate),i[e]?t.call(n):o[e].subscribe(n,t,s)}function u(e){s.push(e)}function h(e,...t){const n=[e].concat(t);s.forEach((e=>{e.apply(null,n)})),o.hasOwnProperty(e)&&o[e].fire.apply(o[e],t)}function d(e){i[e]&&console.warn(`Something went wrong: emitOnce called multiple times with same event (${e})`),i[e]=!0,h.apply(null,arguments)}},314802:(e,t,n)=>{n.d(t,{isOnMobileAppPage:()=>o,urlWithMobileAppParams:()=>s});var r=n(16188);function o(e,t=!1){const{searchParams:n}=new URL(String(location));let o="true"===n.get("mobileapp_new"),s="true"===n.get("mobileapp");if(!t){const e=r.get("tv_app")||"";o||(o=["android","android_nps"].includes(e)),s||(s="ios"===e)}return!("new"!==e&&"any"!==e||!o)||!("new"===e||!s)}function s(e,t=!1){if(o("new",t)){const t=new URL(e,location.href);t.searchParams.set("mobileapp_new","true"),e=t.toString()}if(o("old",t)){const t=new URL(e,location.href);t.searchParams.set("mobileapp","true"),e=t.toString()}return e}},659863:(e,t,n)=>{n.r(t),n.d(t,{qaGlobals:()=>r});const r=new class{constructor(e,t){this._test=e[t]={}}provide(e,t){this._test[e]=t}}(window,"qaGlobals")},175203:(e,t,n)=>{n.d(t,{telemetry:()=>u});var r=n(707957),o=n(120780),s=n(638456),i=n(314802);n(659863);const a=(0,n(201089).getLogger)("Common.Telemetry"),l={default:15e3,site:3e5},c=["before_websocket_connection_time_frame","websocket_connection_time_frame","first_series_full_time_frame","page_full_load_time_frame","page_load_time_frame"];const u=new class{constructor(){this.reportSent=new r.Delegate,this.timeCounters={series:{marks:[]},study:{},pine:{}},this._timeoutIds={},this._commonAdditionalData={cluster:null,userId:"0"},this._reportStash={}}setSessionInfo(e){const t=this._parseCluster(e);null!==t&&(this._commonAdditionalData.cluster=t)}sendReport(e,t,n){var r;if(!this._isAbleToSendReport(t))return;const o=this._getSubserviceType(e),s=this._getHost(e,o);if(null!==s){if(n=void 0===n?{count:1}:n,this._addReportToStash(n,t,s),!this._timeoutIds[e]){const t=null!==(r=l[e])&&void 0!==r?r:l.default;this._timeoutIds[e]=setTimeout(this._sendTelemetryToService.bind(this,e,s),t)}
}else a.logError(`Unable to get host for counter: ${t}, metric type: ${e}, serivce type: ${o}`)}sendChartReport(e,t,n=!0){this._sendServiceSpecifiedReport("charts",e,t,n)}sendLineToolsStorageReport(e,t,n=!0){this._sendServiceSpecifiedReport("line_tools_storage",e,t,n)}_sendServiceSpecifiedReport(e,t,n,r=!0){this._updateUserInfo(),n=void 0===n?{count:1}:n,r&&(n=this._appendCommonAdditionalInfo(n,["cluster","userId"])),this.sendReport(e,t,n)}_updateUserInfo(){const e="user"in window&&"id"in window.user?window.user.id:"0";this._commonAdditionalData.userId=String(e)}_isAbleToSendReport(e){const t=window.TELEMETRY_HOSTS,n=c.includes(e),r=Boolean(window.TradingView.onChartPage||(0,s.onWidget)());return t&&(!n||r)}_sendTelemetryToService(e,t){if(this._reportStash.hasOwnProperty(t)){const e=this._cropParams(this._reportStash[t]),n=this._renameAllParams(e),r={event:"report_stash",params:this._cleanAllParams(n)};a.logDebug(`Report to host: ${t}; stash: ${JSON.stringify(this._reportStash[t])}`),this.reportSent.fire(this._reportStash[t]),delete this._reportStash[t],(0,o.fetch)(`${t}/report`,{method:"POST",body:JSON.stringify(r)})}this._timeoutIds[e]=null}_getHost(e,t){const n=window.TELEMETRY_HOSTS,r=n[e]&&n[e][t];return Boolean(r)?r:null}_getSubserviceType(e){if(!["charts","site"].includes(e))return"all";let t="free";const n=window.user.is_pro;return"charts"===e&&(0,i.isOnMobileAppPage)("old")?t=n?"ios_pro":"ios_free":"charts"===e&&(0,i.isOnMobileAppPage)("new")?t=n?"android_pro":"android_free":(0,s.onWidget)()?t="widget":n&&(t="pro"),t}_parseCluster(e){let t;try{t=JSON.parse(e).session_id}catch(e){return a.logError("Could not parse cluster id (session id)"),null}const n=/(.*@)(.*)/gi.exec(t);return null!==n&&n.length>=3?n[2]:null}_appendCommonAdditionalInfo(e,t){return t.forEach((t=>{t in this._commonAdditionalData&&(e.additional=e.additional||{},e.additional[t]=this._commonAdditionalData[t])})),e}_cropParams(e){var t;for(const n in e)e.hasOwnProperty(n)&&e[n].length>1e3&&(e.too_much_metrics_frame=null!==(t=e.too_much_metrics_frame)&&void 0!==t?t:[],e.too_much_metrics_frame.push({value:e[n].length,additional:{event:n}}),delete e[n]);return e}_renameAllParams(e){const t={};for(const n in e)e.hasOwnProperty(n)&&(t[n]=[],e[n].forEach((e=>{t[n].push(this._renameEntryParams(e))})));return t}_renameEntryParams(e){const t={count:"c",value:"v",text:"t",additional:"a"};return Object.keys(e).reduce(((n,r)=>(n[t[r]]=e[r],n)),{})}_cleanAllParams(e){const t={};for(const n in e)if(e.hasOwnProperty(n)){t[n]=[];const r={c:0};e[n].forEach((e=>{const o=this._cleanEntryParams(e),s=Object.keys(o).length;1===s&&void 0!==o.c?r.c+=o.c:s>0&&t[n].push(o)})),r.c>0&&t[n].push(r),0===t[n].length&&delete t[n]}return t}_cleanEntryParams(e){const t=Object.keys(e).reduce(((t,n)=>"c"!==n&&"t"!==n||e[n]?(t[n]=e[n],t):t),{});return"c"in t||"v"in t||"t"in t?t:{}}_addReportToStash(e,t,n){n in this._reportStash||(this._reportStash[n]={}),t in this._reportStash[n]||(this._reportStash[n][t]=[]),Object.keys(e).length>0&&this._reportStash[n][t].push(e)}}},
345848:(e,t,n)=>{n.d(t,{disableTrackingEvents:()=>c,trackEvent:()=>l});var r=n(251954),o=n(77122);const s=(0,n(201089).getLogger)("Common.TrackEvent"),i=[/Study_(Drawing)_(.*)/,/(Study)_(.*)@tv-basicstudies/,/(Study)_(.*)/,/(Chart Style) (.*)/];let a=!1;const l=(e,t,n)=>{if(a)return;if(o.enabled("charting_library_base"))return void((e,t,n)=>{t=t||e||n||"";let o="";for(let e=0;e<i.length;e++){const n=t.match(i[e]);if(n&&3===n.length){t=n[1],o=n[2];break}}(0,r.emit)(t.toLowerCase().replace(" ","_"),{category:e,label:n,value:o})})(e,t,n);let l=(e?e+":":"")+t;n&&(l+=" "+n),s.logNormal(l),o.enabled("widget")||!window._UNIT_TESTS&&window.gtag&&window.gtag("event",t,{event_category:e,event_label:n})};function c(){a=!0}"undefined"!=typeof window&&(window.TradingView=window.TradingView||{},window.TradingView.trackEvent=l)},226722:(e,t,n)=>{n.r(t),n.d(t,{TVXWindowEvents:()=>i,getScopedTVXWindowEvents:()=>a});n(586463);var r=n(201089),o=n(49437);const s=(0,r.getLogger)("XWindowEvents");var i;function a(e){return{on:(t,n)=>i.on(`${e}.${t}`,n),off:(t,n)=>i.off(`${e}.${t}`,n),emit:(t,n)=>i.emit(`${e}.${t}`,n)}}!function(e){const t="tvxwevents.",n={};let r;window.BroadcastChannel?(r=new BroadcastChannel("tvxwevents"),r.addEventListener("message",(function(e){const{data:{event:t,value:r}}=e;n[t]&&n[t].forEach((e=>{e(r)}))})),function(){const e=[],n=performance.now();for(let n=0;n<o.TVLocalStorage.length;n++){const r=o.TVLocalStorage.key(n);r.startsWith(t)&&e.push(r)}const r=o.TVLocalStorage.length;for(const t of e)o.TVLocalStorage.removeItem(t);const i=performance.now()-n;s.logNormal(`Total keys amount in local storage on operation start: ${r}`),s.logNormal(`Keys amount in local storage to be deleted: ${e.length}`),s.logNormal(`Keys to be deleted from local storage: ${JSON.stringify(e)}`),s.logNormal(`Removing keys from local storage took ${i} ms`)}()):window.addEventListener("storage",(function(e){const{newValue:r,key:s}=e;if(null===r||!s||!s.startsWith(t))return;const i=s.substring(t.length);n[i]&&n[i].forEach((t=>{t(e.newValue)}));o.TVLocalStorage.removeItem(s)})),e.on=function(e,t){n[e]||(n[e]=[]),n[e].push(t)},e.off=function(e,t){if(!n[e])return;const r=n[e].indexOf(t);-1!==r&&(1===n[e].length?delete n[e]:n[e].splice(r,1))},e.emit=function(e,n=Date.now()){try{r?r.postMessage({event:e,value:n}):o.TVLocalStorage.setItem(t+e,n.toString())}catch(e){s.logError(e.message)}}}(i||(i={}))},428123:(e,t,n)=>{function r(e){const t=Object.create(e);return t.release=()=>{},t.ownership=()=>t,t}function o(e){const t=Object.create(e);return t.release=()=>e.destroy(),t.ownership=()=>t,t}n.d(t,{ownership:()=>o,weakReference:()=>r})},129025:(e,t,n)=>{n.r(t),n.d(t,{WatchedValue:()=>i});var r=n(428123);const o=(0,n(194582).getLogger)("Common.WatchedValue");function s(e){o.logError(`${e&&(e.stack||e.message)}`)}class i{constructor(...e){this._listeners=[],e.length>0&&(this._value=e[0])}destroy(){this.unsubscribe()}value(){return this._owner?this._owner._value:this._value}setValue(e,t){const n=this._owner?this._owner:this
;if("function"==typeof n.hook&&(e=n.hook(e)),n.writeLock)return;const r=n._value===e||Number.isNaN(n._value)&&Number.isNaN(e);if(!t&&r&&n.hasOwnProperty("_value"))return;n._value=e;const o=n._listeners.slice();let i=0;for(let t=0;t<o.length;t++){o[t].once&&(n._listeners.splice(t-i,1),i++);try{o[t].cb(e)}catch(e){s(e)}}}deleteValue(){this.setValue(void 0)}subscribe(e,t){if("function"!=typeof e)throw new TypeError("callback must be a function");const n=!!t&&!!t.once,r=!!t&&!!t.callWithLast,o=this._owner?this._owner:this;if(r&&o.hasOwnProperty("_value")){try{e(o._value)}catch(e){s(e)}if(n)return}o._listeners.push({cb:e,owner:this,once:!!t&&!!t.once})}unsubscribe(e){const t=this._owner?this._owner:this;void 0===e&&(e=null);const n=t._listeners;for(let r=n.length;r--;)n[r].owner!==this&&t!==this||n[r].cb!==e&&null!==e||n.splice(r,1)}readonly(){if(this._readonlyInstance)return this._readonlyInstance;const e={subscribe:this.subscribe.bind(this),unsubscribe:this.unsubscribe.bind(this),value:this.value.bind(this),when:this.when.bind(this),ownership:this.ownership.bind(this),spawnOwnership:this.spawnOwnership.bind(this),weakReference:this.weakReference.bind(this),spawn:e=>this.spawn(e).readonly(),destroy:this.destroy.bind(this)};return this._readonlyInstance=e,e}spawn(e){return new a(this._owner||this,e)}when(e){!function(e,t,n){if(t(e.value()))return void n();const r=o=>{t(o)&&(e.unsubscribe(r),n())};e.subscribe(r,{callWithLast:!0})}(this,(e=>Boolean(e)),(()=>{try{e(this.value())}catch(e){s(e)}}))}assertNoSubscriptions(){0}ownership(){return(0,r.ownership)(this)}spawnOwnership(){return(0,r.ownership)(this.spawn())}weakReference(){return(0,r.weakReference)(this)}}class a extends i{constructor(e,t){super(),delete this._listeners,this._owner=e,this._onDestroy=t}destroy(){var e;try{null===(e=this._onDestroy)||void 0===e||e.call(this)}catch(e){s(e)}super.destroy()}readonly(){return super.readonly()}}},266325:(e,t,n)=>{function r(e){let t=null;return(n,...r)=>(null==t||t.abort(),t=new AbortController,null==n||n.addEventListener("error",(()=>null==t?void 0:t.abort()),{once:!0}),e(t.signal,...r))}function o(e){if(!l(e))throw e}function s(e){if(l(e))throw e}function i(e){return(null==e?void 0:e.aborted)?Promise.reject(a()):new Promise(((t,n)=>{null==e||e.addEventListener("abort",(()=>n(a())),{once:!0})}))}function a(){return new DOMException("Aborted","AbortError")}function l(e){return e instanceof Error&&"AbortError"===e.name}function c(e,t){return Promise.race([i(e),t])}async function u(e,t){let n;try{await c(e,new Promise((e=>{n=setTimeout(e,t)})))}finally{clearTimeout(n)}}n.d(t,{createAbortError:()=>a,delay:()=>u,isAbortError:()=>l,respectAbort:()=>c,respectLatest:()=>r,rethrowAbortError:()=>s,skipAbortError:()=>o})},16188:(e,t,n)=>{function r(e,t,n,r,o){let s="";if(r=r?"; path="+r:"",o=o?"; domain="+o:"",n){const e=new Date;e.setTime(e.getTime()+24*n*60*60*1e3),s="; expires="+e.toUTCString()}else s="";document.cookie=e+"="+t+s+o+r}function o(e){const t=e+"=",n=document.cookie.split(";");for(let e=0;e<n.length;e++){let r=n[e]
;for(;" "===r.charAt(0);)r=r.substring(1,r.length);if(0===r.indexOf(t))return r.substring(t.length,r.length)}return null}n.d(t,{get:()=>o,set:()=>r})},268222:(e,t,n)=>{function r(){let e,t;return{promise:new Promise(((n,r)=>{e=n,t=r})),reject:t,resolve:e}}n.d(t,{createDeferredPromise:()=>r})},541558:(e,t,n)=>{n.r(t),n.d(t,{guid:()=>o,randomHash:()=>s,randomHashN:()=>i});const r="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";function o(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(e=>{const t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))}function s(){return i(12)}function i(e){let t="";for(let n=0;n<e;++n){const e=Math.floor(Math.random()*r.length);t+=r[e]}return t}}}]);