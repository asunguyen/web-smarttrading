"use strict";(self.webpackChunktradingview=self.webpackChunktradingview||[]).push([[19482,62078],{223124:(e,t,n)=>{n.d(t,{isCancelled:()=>r,makeCancelable:()=>o});class s extends Error{constructor(){super("CancelToken")}}function o(e){let t=!1;return{promise:new Promise(((n,o)=>{e.then((e=>t?o(new s):n(e))),e.catch((e=>o(t?new s:e)))})),cancel(){t=!0}}}function r(e){return e instanceof s}},262078:(e,t,n)=>{n.r(t),n.d(t,{pushStreamMultiplexer:()=>x});var s=n(226722),o=n(345848),r=n(49437),i=n(944454),a=n(175203),c=n(201089),l=n(650151),h=n(368654),u=n(774965);class d{constructor(e){this._queue=[],this._isWorking=!1,this._onResolve=()=>{this._queue.length>0&&this._createPromise(this._queue[0])},this._logger=e}enqueue(e){this._logger.logNormal(`Adding channel in stack. Queue size: ${this._queue.length}`),this._isWorking||this._createPromise(e),this._queue.push(e)}_createPromise(e){this._isWorking=!0,this._wrap(e).then(this._onResolve)}_wrap(e){return new Promise((t=>{e().catch((e=>this._logger.logNormal(`Error when trying handling channel: ${e.message}`))).finally((()=>{this._isWorking=!1,this._queue.shift(),t()}))}))}}const _="PushStream",g=(0,c.getLogger)(_);var C;!function(e){e[e.EventSource=0]="EventSource",e[e.WebSocket=1]="WebSocket"}(C||(C={}));class m{constructor(e,t){this._channels=[],this._queue=new d(g),this._transport=t.transportType===C.EventSource?new h.PersistentEventSourceTransport(this._onPushStreamMessage.bind(this)):new u.PersistentWebsocketTransport(this._onPushStreamMessage.bind(this),this._onPushStreamClose.bind(this)),this._settings=t,this._messageHandler=e}addChannel(e){this._queue.enqueue((()=>this._addChannel(e)))}removeChannel(e){this._queue.enqueue((()=>this._removeChannel(e)))}getChannels(){return this._channels}hasChannel(e){return-1!==this._channels.indexOf(e)}connectionStatus(){return this._transport.connectionStatus()}reconnectEvent(){return this._transport.successReconnectReachedEvent()}connect(){(0,l.assert)(0!==this._channels.length,"There is no channels"),this._transport.connect()}disconnect(){this._transport.disconnect()}getLogs(e){return(0,c.getRawLogHistory)(e,_)}async _addChannel(e){(0,l.assert)(!this.hasChannel(e),`Channel with name ${e} has already been subscribed`),g.logNormal(`Adding channel ${e}`),this._channels.push(e);const{maxSize:t}=this._settings;return void 0!==t&&this._channels.length>t&&(this._channels=this._channels.slice(this._channels.length-t)),this._transport.setUrl(this._generateUrl())}async _removeChannel(e){const t=this._channels.indexOf(e);return(0,l.assert)(-1!==t,`There is no channel with name ${e}`),g.logNormal(`Removing channel ${e}`),this._channels.splice(t,1),this._transport.setUrl(this._generateUrl())}_onPushStreamMessage(e){if("string"!=typeof e)throw new Error("Wrong message type, expected string");const t=JSON.parse(e),n=t.id,s=t.channel;-2===n?g.logWarn("Received unexpected message: about removed the channel"):n>0&&(g.logDebug(`Received message: id="${n}" channel="${s}"`),this._messageHandler(t.text,n,s))}_onPushStreamClose(e){
1005===e.code&&a.telemetry.sendChartReport("websocket_code_1005")}_generateUrl(){const e=this._channels.join("/");return g.logNormal(`Generate pushstream url - ${e}`),`${this._settings.url}/${this._settings.urlPath}/${e}`}}n(659863);class p{constructor(){this._handlers={},this._specialHandlers={}}on(e,t){const n=this._isSpecialChannel(e)?this._specialHandlers:this._handlers;n[e]||(n[e]=[]),n[e].push(t)}off(e,t){const n=this._isSpecialChannel(e)?this._specialHandlers:this._handlers;if(!(e in n))return;if(void 0===t)return void delete n[e];const s=n[e].indexOf(t);s>=0&&n[e].splice(s,1)}emit(e,t,n,s){this._handlers[n]&&this._handlers[n].forEach((o=>{o(e,t,n,s)}));for(const o of Object.keys(this._specialHandlers)){const r="^"+o.replace(/\*/g,".*?")+"$";new RegExp(r).test(n)&&this._specialHandlers[o].forEach((o=>{o(e,t,n,s)}))}}_isSpecialChannel(e){return/\*/.test(e)}}var S=n(125226),v=n(541558),b=n(314802),f=n(707957),w=n(268222),P=n(167175);function E(){return!P.isIOS&&!P.isIPad&&void 0!==navigator.locks}class k{constructor(){this._id=(0,v.guid)(),this._state={[this._id]:{}},this._xEventPrefix="multiplexer-state-",this._xEventCreateTab=this._xEventPrefix+"create-new-tab",this._xEventShareState=this._xEventPrefix+"share-state",this._lockName="tab_destruction",this._stateChangeDelegate=new f.Delegate,this._createdLocks={},this._lockEnabled=E(),this._lockPromise=(0,w.createDeferredPromise)(),this._onTabCreateCb=null,this._onTabCreate=e=>{this._onTabCreateCb&&this._onTabCreateCb();const t=JSON.parse(e);this._state[t]={},this._shareState(),this._requestTabRemoveLock(t)},this._shareState=()=>{const e=JSON.stringify([this._id,this._state[this._id]]);s.TVXWindowEvents.emit(this._xEventShareState,e)},this._requestTabRemoveLock=e=>{!this._createdLocks[e]&&this._lockEnabled&&(this._createdLocks[e]=1,navigator.locks.request(`${this._lockName}_${e}`,(async()=>{const t=this._state[e]||{};this._compareTabState(e,{},t,"add"),this._compareTabState(e,t,{},"remove"),delete this._state[e],delete this._createdLocks[e]})))},this._onShareStateFromOther=e=>{const[t,n]=JSON.parse(e),s=this._state[t]||{};this._compareTabState(t,n,s,"add"),this._compareTabState(t,s,n,"remove"),this._state[t]=n,this._requestTabRemoveLock(t)},this._removeChannel=(e,t)=>{delete this._state[this._id][e][t],this._isListenByAnotherTab(e,t)||this._stateChangeDelegate.fire("remove",e,t);0===Object.keys(this._state[this._id][e]).length&&delete this._state[this._id][e]},s.TVXWindowEvents.on(this._xEventCreateTab,this._onTabCreate),s.TVXWindowEvents.on(this._xEventShareState,this._onShareStateFromOther),this._lockEnabled&&navigator.locks.request(`${this._lockName}_${this._id}`,(async()=>(s.TVXWindowEvents.emit(this._xEventCreateTab,JSON.stringify(this._id)),window.addEventListener("beforeunload",(()=>this._lockPromise.resolve())),this._lockPromise.promise)))}addChannel(e,t){this._isNotEmpty(e,t)?this._state[this._id][e][t]++:(this._state[this._id][e]||(this._state[this._id][e]={}),this._state[this._id][e][t]=1),
this._isListenByAnotherTab(e,t)||this._stateChangeDelegate.fire("add",e,t),this._shareState()}removeChannel(e,t){this._isExist(e,t)&&(this._state[this._id][e][t]--,this._isNotEmpty(e,t)||this._removeChannel(e,t),this._shareState())}collectPushStreamChannels(e){const t=new Set;return Object.keys(this._state).forEach((n=>{const s=this._state[n][e];this._state[n][e]&&Object.keys(s).forEach((e=>t.add(e)))})),Array.from(t)}onStateChange(e){this._stateChangeDelegate.subscribe(null,e)}offStateChange(e){this._stateChangeDelegate.unsubscribe(null,e)}onTabCreate(e){this._onTabCreateCb=e}_isExist(e,t,n=this._id){return void 0!==this._state[n]&&void 0!==this._state[n][e]&&void 0!==this._state[n][e][t]}_isNotEmpty(e,t,n=this._id){return this._isExist(e,t,n)&&this._state[n][e][t]>0}_compareTabState(e,t,n,s){Object.keys(t).forEach((o=>{Object.keys(t[o]).forEach((t=>{this._isListenByAnotherTab(o,t,e)||n[o]&&n[o][t]||this._stateChangeDelegate.fire(s,o,t)}))}))}_isListenByAnotherTab(e,t,n=this._id){return Object.keys(this._state).some((s=>s!==n&&this._isNotEmpty(e,t,s)))}}const y=(0,c.getLogger)(_),T={url:window.PUSHSTREAM_URL,urlPath:"message-pipe-ws",transportType:C.WebSocket},F={url:window.PUSHSTREAM_URL.replace("wss://","https://"),urlPath:"message-pipe-es",transportType:C.EventSource};class L{constructor(){var e;this.guid=(0,v.guid)(),this._pushStreamPublic=null,this._pushStreamPrivate=null,this._statusHandlers=[],this._reconnectHandlers=[],this._userPrivateChannel=null,this._channelMultiplexer=new p,this._xEventPrefix="multiplexer-bc-",this._storagePrefix="pushStreamMultiplexerState.",this._userChannelPrefix="private_",this._statusPublic=i.ConnectionStatus.Closed,this._statusPrivate=i.ConnectionStatus.Closed,this._xEventSend=this._xEventPrefix+"send",this._xEventConnectionStatus=this._xEventPrefix+"connectionStatus",this._xEventReconnectCommand=this._xEventPrefix+"reconnectCommand",this._xEventReconnectSuccess=this._xEventPrefix+"reconnectSuccess",this._xEventRequestLogs=this._xEventPrefix+"requestLogs",this._xEventShareLogs=this._xEventPrefix+"shareLogs",this._state=new k,this._shareLogsKey=this._storagePrefix+"shareLogs",this._lockName="pushstream",this._lockPromise=(0,w.createDeferredPromise)(),this._dispatchReconnectSuccessCommandFromOther=e=>{if(this.ownPushStream())return;const[t]=this._decodeParams(e);this._callReconnectHandlers(t)},this._dispatchMessage=(e,t,n)=>{this._dispatchMessageToOthers(e,t,n),this._dispatchMessageToSelf(e,t,n,!1)},this._dispatchMessageFromOther=e=>{if(this.ownPushStream())return;const[t,n,s]=this._decodeParams(e);this._dispatchMessageToSelf(t,n,s,!0)},this._dispatchStatusChangeFromOther=e=>{const t=this._decodeConnectionStatus(e),n=t[0],s=t[1];this.ownPushStream()||this._dispatchStatusChangeToSelf(n,s)},this._dispatchReconnectCommandFromOther=()=>{this.ownPushStream()&&this.forceConnect()},this._onRequestLogs=()=>{if(this.ownPushStream()){const e=this._getOwnLogs();let t="";try{t=JSON.stringify(e)}catch(e){y.logError("Failed to stringify own pushstream logs")}
r.TVLocalStorage.setItem(this._shareLogsKey,t),s.TVXWindowEvents.emit(this._xEventShareLogs,t)}},this._onStateChange=(e,t,n)=>{const s="private"===t?this._pushStreamPrivate:this._pushStreamPublic;"add"===e?null==s||s.addChannel(n):null==s||s.removeChannel(n)},this._onNewTabCreate=()=>{this._dispatchStatusChangeToOthers(this._statusPublic,this._statusPrivate)},E()?navigator.locks.request(this._lockName,(async()=>(this._state.onStateChange(this._onStateChange),this._state.onTabCreate(this._onNewTabCreate),this._instantiatePushStream(),window.addEventListener("beforeunload",(()=>this._lockPromise.resolve())),this._lockPromise.promise))):(this._state.onStateChange(this._onStateChange),this._instantiatePushStream()),s.TVXWindowEvents.on(this._xEventSend,this._dispatchMessageFromOther),s.TVXWindowEvents.on(this._xEventConnectionStatus,this._dispatchStatusChangeFromOther),s.TVXWindowEvents.on(this._xEventReconnectCommand,this._dispatchReconnectCommandFromOther),s.TVXWindowEvents.on(this._xEventReconnectSuccess,this._dispatchReconnectSuccessCommandFromOther),s.TVXWindowEvents.on(this._xEventRequestLogs,this._onRequestLogs),e=()=>{window.loginStateChange&&window.loginStateChange.subscribe(this,this._changeLoginState)},"loading"!==document.readyState?e():document.addEventListener("DOMContentLoaded",e)}on(e,t){this._channelMultiplexer.on(e,t)}off(e,t){this._channelMultiplexer.off(e,t)}onStatus(e){this._statusHandlers.push({handler:e,isPrivate:!1}),setTimeout((()=>e(this._statusPublic)),0)}onPrivateStatus(e){this._statusHandlers.push({handler:e,isPrivate:!0}),setTimeout((()=>e(this._statusPrivate)),0)}onReconnect(e,t=!1){this._reconnectHandlers.push({handler:e,isPrivate:t})}offReconnect(e){this._reconnectHandlers=this._reconnectHandlers.filter((t=>t.handler!==e))}offStatus(e){this._statusHandlers=this._statusHandlers.filter((t=>t.handler!==e))}forceConnect(){var e,t;y.logNormal(`Creating pushstream connection after force connect. Main tab: ${this.ownPushStream()}`),this.ownPushStream()?(null===(e=this._pushStreamPublic)||void 0===e||e.disconnect(),null===(t=this._pushStreamPrivate)||void 0===t||t.disconnect(),this._instantiatePushStream()):s.TVXWindowEvents.emit(this._xEventReconnectCommand)}disconnect(){this.ownPushStream()&&this._destructPushStream()}getLogs(e){return new Promise((t=>{const n=setTimeout((()=>{const e=r.TVLocalStorage.getItem(this._shareLogsKey);t(null!==e?JSON.parse(e):[])}),1e3),o=e=>{let r;s.TVXWindowEvents.off(this._xEventShareLogs,o),s.TVXWindowEvents.emit(this._xEventShareLogs,""),clearTimeout(n);try{r=JSON.parse(e)}catch(e){r=[],y.logError("Failed to parse logs received from master tab")}t(r)};this.ownPushStream()?t(this._getOwnLogs(e)):(s.TVXWindowEvents.on(this._xEventShareLogs,o),s.TVXWindowEvents.emit(this._xEventRequestLogs))}))}ownPushStream(){return!!this._pushStreamPublic||!!this._pushStreamPrivate}pushStream(){if(!this.ownPushStream())throw new Error("Not own PushStream");return this._pushStreamPublic}isConnected(){return this._statusPublic>0}status(){var e
;return null!==(e=this._statusPublic)&&void 0!==e?e:i.ConnectionStatus.Closed}statusPrivate(){var e;return null!==(e=this._statusPrivate)&&void 0!==e?e:i.ConnectionStatus.Closed}userChannel(){if(!this._userPrivateChannel)throw new Error("No user channel");return this._userChannel(this._userPrivateChannel)}addChannel(e){this._state.addChannel(e.startsWith(this._userChannelPrefix)?"private":"public",e)}removeChannel(e){this._state.removeChannel(e.startsWith(this._userChannelPrefix)?"private":"public",e)}static getInstance(){return null===this._instance&&(this._instance=new L),this._instance}_userChannel(e){return this._userChannelPrefix+e}_codeParams(e){const t=[...e];return t.push((new Date).getTime()),JSON.stringify(t)}_decodeParams(e){const t=JSON.parse(e);return t.pop(),t}_instantiatePushStream(){this._pushStreamPublic&&((0,o.trackEvent)("PushstreamDoublePublic",window.user&&window.user.username||"Guest",navigator.userAgent),this._pushStreamPublic.disconnect());const e=this._getPushStreamSettings();this._pushStreamPublic=new m(this._dispatchMessage,e),this._pushStreamPublic.connectionStatus().subscribe((e=>{this._dispatchStatusChange(e,this._statusPrivate)})),this._pushStreamPublic.reconnectEvent().subscribe(null,(()=>{this._dispatchReconnectSuccessCommand()})),this._pushStreamPrivate&&((0,o.trackEvent)("PushstreamDoublePrivate",window.user&&window.user.username||"Guest",navigator.userAgent),this._pushStreamPrivate.disconnect()),this._pushStreamPrivate=new m(this._dispatchMessage,{...e,maxSize:1}),this._pushStreamPrivate.connectionStatus().subscribe((e=>{this._dispatchStatusChange(this._statusPublic,e)})),this._pushStreamPrivate.reconnectEvent().subscribe(null,(()=>{this._dispatchReconnectSuccessCommand(!0)})),this.on("pushstream_set_user_channel",(e=>{this._setUserChannel(e)})),this._connectChannels()}_destructPushStream(){const e=this._pushStreamPublic;this._pushStreamPublic=null,null==e||e.disconnect();const t=this._pushStreamPrivate;this._pushStreamPrivate=null,null==t||t.disconnect(),this._dispatchStatusChangeFromOther(this._codeParams([i.ConnectionStatus.Closed,i.ConnectionStatus.Closed]))}_connectChannels(){var e,t;null===(e=this._pushStreamPublic)||void 0===e||e.addChannel("public");const n=this._state.collectPushStreamChannels("public");void 0!==n&&n.length>0&&n.map((e=>{var t;return null===(t=this._pushStreamPublic)||void 0===t?void 0:t.addChannel(e)})),"is_authenticated"in window?this._connectUserChannelInitial(!0):window.loginStateChange&&window.loginStateChange.subscribe(this,this._connectUserChannelInitial),this._isPublicPushstreamEnabled()&&(null===(t=this._pushStreamPublic)||void 0===t||t.connect())}_getPushStreamSettings(){return(0,b.isOnMobileAppPage)("any")?(0,S.isFeatureEnabled)("enable_eventsource_pushstream_mobile")?F:T:(0,S.isFeatureEnabled)("enable_eventsource_pushstream_transport")?F:T}_isPublicPushstreamEnabled(){return(0,b.isOnMobileAppPage)("any")||!(0,S.isFeatureEnabled)("disable_pushstream_connections_for_anonymous_users")||window.is_authenticated||window.TradingView.onChartPage}
_connectUserChannelInitial(e){var t,n,s;e&&(window.is_authenticated?(this._userPrivateChannel=null!==(t=window.user.private_channel)&&void 0!==t?t:null,null===(n=this._pushStreamPrivate)||void 0===n||n.addChannel(this.userChannel()),null===(s=this._pushStreamPrivate)||void 0===s||s.connect()):this._userPrivateChannel=null)}_changeLoginState(e){var t,n,s,o,r,i;e||(this._isPublicPushstreamEnabled()&&(null===(t=this._pushStreamPublic)||void 0===t||t.connect()),window.is_authenticated?(this._userPrivateChannel=null!==(n=window.user.private_channel)&&void 0!==n?n:null,this.ownPushStream()&&(null===(s=this._pushStreamPrivate)||void 0===s||s.addChannel(this.userChannel()),null===(o=this._pushStreamPrivate)||void 0===o||o.connect())):(this.ownPushStream()&&(null===(r=this._pushStreamPrivate)||void 0===r||r.removeChannel(this.userChannel()),null===(i=this._pushStreamPrivate)||void 0===i||i.disconnect()),this._userPrivateChannel=null))}_setUserChannel(e){var t,n;y.logNormal("Set user channel "+e),e!==this._userPrivateChannel&&(this.ownPushStream()&&this._userPrivateChannel&&(null===(t=this._pushStreamPrivate)||void 0===t||t.removeChannel(this.userChannel())),this._userPrivateChannel=e,this.ownPushStream()&&this._userPrivateChannel&&(null===(n=this._pushStreamPrivate)||void 0===n||n.addChannel(this.userChannel())))}_dispatchStatusChange(e,t){this._dispatchStatusChangeToOthers(e,t),this._dispatchStatusChangeToSelf(e,t)}_dispatchStatusChangeToSelf(e,t){e!==this._statusPublic&&(this._statusPublic=e,this._callStatusHandlers(e,!1)),t!==this._statusPrivate&&(this._statusPrivate=t,this._callStatusHandlers(t,!0))}_callStatusHandlers(e,t){y.logNormal("Connection status change: "+e+", private "+t+", is main tab "+this.ownPushStream()),a.telemetry.sendReport("site","pushstream_status_change"),this._statusHandlers.forEach((n=>{n.isPrivate===t&&n.handler(e)}))}_callReconnectHandlers(e){this._reconnectHandlers.forEach((t=>{t.isPrivate===e&&t.handler()}))}_dispatchReconnectSuccessCommand(e=!1){if(this.ownPushStream()){this._callReconnectHandlers(e);const t=this._codeParams([e]);s.TVXWindowEvents.emit(this._xEventReconnectSuccess,t)}}_decodeConnectionStatus(e){const t=parseInt(e,10);return isNaN(t)?this._decodeParams(e):[t,t]}_dispatchStatusChangeToOthers(e,t){if(this.ownPushStream()){const n=this._codeParams([e,t]);s.TVXWindowEvents.emit(this._xEventConnectionStatus,n)}}_dispatchMessageToSelf(e,t,n,s){const o=e.channel,r=e.content;this._emit(r,t,o,s)}_dispatchMessageToOthers(e,t,n){const o=[e,t,n];s.TVXWindowEvents.emit(this._xEventSend,this._codeParams(o))}_emit(e,t,n,s){this._channelMultiplexer.emit(e,t,n,s)}_getOwnLogs(e){var t;if(this.ownPushStream()){const n=(0,c.getRawLogHistory)(e,_),s=null===(t=this.pushStream())||void 0===t?void 0:t.getLogs();return[].concat(n,null!=s?s:[])}return[]}}L._instance=null;const x=L.getInstance()},564894:(e,t,n)=>{n.d(t,{hasService:()=>c,registerService:()=>i,service:()=>l,unregisterService:()=>a,waitServiceRegistered:()=>h});var s=n(268222);const o={},r=new Map;function i(e,t){
if(c(e))throw new Error("Service already registered");o[e.id]=t;const n=r.get(e.id);void 0!==n&&(r.delete(e.id),n.resolve(t))}function a(e){if(!c(e))throw new Error("Service not found");o[e.id]=void 0}function c(e){return void 0!==o[e.id]}function l(e){const t=o[e.id];if(void 0===t)throw new Error("ServiceLocator: Service "+e.id+" not found");return t}function h(e){if(c(e))return Promise.resolve(l(e));let t=r.get(e.id);return void 0===t&&(t=(0,s.createDeferredPromise)(),r.set(e.id,t)),t.promise}},919346:(e,t,n)=>{n.r(t),n.d(t,{StdTheme:()=>a.StdTheme,getStdChartTheme:()=>h,getStdThemeNames:()=>l,getThemeNameIfStdTheme:()=>_,isStdTheme:()=>d,translateThemeName:()=>u});var s=n(444372),o=n(724377)
;const r=JSON.parse('{"content":{"chartProperties":{"scalesProperties":{"textColor":"#131722","lineColor":"rgba(42, 46, 57, 0)","backgroundColor":"#ffffff"},"paneProperties":{"vertGridProperties":{"color":"rgba(42, 46, 57, 0.06)"},"horzGridProperties":{"color":"rgba(42, 46, 57, 0.06)"},"crossHairProperties":{"color":"#9598A1"},"background":"#ffffff","backgroundGradientStartColor":"#ffffff","backgroundGradientEndColor":"#ffffff","separatorColor":"#E0E3EB"}},"sessions":{"graphics":{"backgrounds":{"outOfSession":{"color":"#2962FF","transparency":92},"preMarket":{"color":"#FF9800","transparency":92},"postMarket":{"color":"#2962FF","transparency":92}},"vertlines":{"sessBreaks":{"color":"#4985e7","style":2,"width":1}}}},"mainSourceProperties":{"baseLineColor":"#B2B5BE","candleStyle":{"borderColor":"#378658","upColor":"#089981","wickColor":"#737375","wickUpColor":"#089981","wickDownColor":"#F23645","downColor":"#F23645","borderUpColor":"#089981","borderDownColor":"#F23645"},"haStyle":{"borderColor":"#378658","upColor":"#089981","wickColor":"#737375","wickUpColor":"#089981","wickDownColor":"#F23645","downColor":"#F23645","borderUpColor":"#089981","borderDownColor":"#F23645"},"barStyle":{"downColor":"#F23645","upColor":"#089981"},"pnfStyle":{"downColor":"#F23645","upColor":"#089981","upColorProjection":"#a9dcc3","downColorProjection":"#f5a6ae"},"baselineStyle":{"baselineColor":"#758696","topFillColor1":"rgba(8, 153, 129, 0.28)","topFillColor2":"rgba(8, 153, 129, 0.05)","bottomFillColor1":"rgba(242, 54, 69, 0.05)","bottomFillColor2":"rgba(242, 54, 69, 0.28)","topLineColor":"#089981","bottomLineColor":"#F23645"},"areaStyle":{"transparency":100,"color1":"rgba(41, 98, 255, 0.28)","color2":"#2962FF","linecolor":"#2962FF","linewidth":2,"linestyle":0},"hiloStyle":{"color":"#2962FF","borderColor":"#2962FF","labelColor":"#2962FF"},"columnStyle":{"upColor":"rgba(8, 153, 129, 0.5)","downColor":"rgba(242, 54, 69, 0.5)","priceSource":"close"},"renkoStyle":{"upColor":"#089981","downColor":"#F23645","borderUpColor":"#089981","borderDownColor":"#F23645","upColorProjection":"#a9dcc3","downColorProjection":"#f5a6ae","borderUpColorProjection":"#a9dcc3","borderDownColorProjection":"#f5a6ae","wickUpColor":"#089981","wickDownColor":"#F23645"},"lineStyle":{"color":"#2962FF","linewidth":2,"linestyle":0},"lineWithMarkersStyle":{"color":"#2962FF","linewidth":2,"linestyle":0},"steplineStyle":{"color":"#2962FF","linewidth":2,"linestyle":0},"kagiStyle":{"downColor":"#F23645","upColor":"#089981","upColorProjection":"#a9dcc3","downColorProjection":"#f5a6ae"},"pbStyle":{"upColor":"#089981","downColor":"#F23645","borderUpColor":"#089981","borderDownColor":"#F23645","upColorProjection":"#a9dcc3","downColorProjection":"#f5a6ae","borderUpColorProjection":"#a9dcc3","borderDownColorProjection":"#f5a6ae"},"rangeStyle":{"upColor":"#089981","downColor":"#F23645","upColorProjection":"#a9dcc3","downColorProjection":"#f5a6ae"}}}}'),i=JSON.parse('{"content":{"chartProperties":{"scalesProperties":{"textColor":"#B2B5BE","lineColor":"rgba(240, 243, 250, 0)","backgroundColor":"#ffffff"},"paneProperties":{"vertGridProperties":{"color":"rgba(240, 243, 250, 0.06)"},"horzGridProperties":{"color":"rgba(240, 243, 250, 0.06)"},"crossHairProperties":{"color":"#9598A1"},"background":"#131722","backgroundGradientStartColor":"#181C27","backgroundGradientEndColor":"#131722","backgroundType":"gradient","separatorColor":"#2A2E39"}},"sessions":{"graphics":{"backgrounds":{"outOfSession":{"color":"#2962FF","transparency":92},"preMarket":{"color":"#FF9800","transparency":92},"postMarket":{"color":"#2962FF","transparency":92}},"vertlines":{"sessBreaks":{"color":"#4985e7","style":2,"width":1}}}},"mainSourceProperties":{"baseLineColor":"#5d606b","candleStyle":{"borderColor":"#378658","upColor":"#089981","wickColor":"#B5B5B8","wickUpColor":"#089981","wickDownColor":"#F23645","downColor":"#F23645","borderUpColor":"#089981","borderDownColor":"#F23645"},"haStyle":{"borderColor":"#378658","upColor":"#089981","wickColor":"#B5B5B8","wickUpColor":"#089981","wickDownColor":"#F23645","downColor":"#F23645","borderUpColor":"#089981","borderDownColor":"#F23645"},"barStyle":{"downColor":"#F23645","upColor":"#089981"},"pnfStyle":{"downColor":"#F23645","upColor":"#089981","upColorProjection":"#336854","downColorProjection":"#7f323f"},"baselineStyle":{"baselineColor":"#758696","topFillColor1":"rgba(8, 153, 129, 0.28)","topFillColor2":"rgba(8, 153, 129, 0.05)","bottomFillColor1":"rgba(242, 54, 69, 0.05)","bottomFillColor2":"rgba(242, 54, 69, 0.28)","topLineColor":"#089981","bottomLineColor":"#F23645"},"areaStyle":{"transparency":100,"color1":"rgba(41, 98, 255, 0.28)","color2":"#2962FF","linecolor":"#2962FF","linewidth":2,"linestyle":0},"hiloStyle":{"color":"#2962FF","borderColor":"#2962FF","labelColor":"#2962FF"},"columnStyle":{"upColor":"rgba(8, 153, 129, 0.5)","downColor":"rgba(242, 54, 69, 0.5)","priceSource":"close"},"renkoStyle":{"upColor":"#089981","downColor":"#F23645","borderUpColor":"#089981","borderDownColor":"#F23645","upColorProjection":"#336854","downColorProjection":"#7f323f","borderUpColorProjection":"#336854","borderDownColorProjection":"#7f323f","wickUpColor":"#089981","wickDownColor":"#F23645"},"lineStyle":{"color":"#2962FF","linewidth":2,"linestyle":0},"lineWithMarkersStyle":{"color":"#2962FF","linewidth":2,"linestyle":0},"steplineStyle":{"color":"#2962FF","linewidth":2,"linestyle":0},"kagiStyle":{"downColor":"#F23645","upColor":"#089981","upColorProjection":"#336854","downColorProjection":"#7f323f"},"pbStyle":{"upColor":"#089981","downColor":"#F23645","borderUpColor":"#089981","borderDownColor":"#F23645","upColorProjection":"#336854","downColorProjection":"#7f323f","borderUpColorProjection":"#336854","borderDownColorProjection":"#7f323f"},"rangeStyle":{"upColor":"#089981","downColor":"#F23645","upColorProjection":"#336854","downColorProjection":"#7f323f"}}}}')
;var a=n(61499);function c(){return{[a.StdTheme.Light]:JSON.parse(JSON.stringify(r)),[a.StdTheme.Dark]:JSON.parse(JSON.stringify(i))}}function l(){return[a.StdTheme.Light,a.StdTheme.Dark]}function h(e){return c()[e]}function u(e){return{[a.StdTheme.Light]:s.t(null,{context:"colorThemeName"},n(669841)),[a.StdTheme.Dark]:s.t(null,{context:"colorThemeName"},n(14642))}[e]||e}function d(e){const t=c();return l().some((n=>g(t[n],e)))}function _(e){const t=c(),n=l();for(const s of n)if(g(t[s],e))return s;return null}function g(e,t){let n=e.content===t.content;return function(e={},t){try{C(e,[],t)}catch(e){return}}(e.content,((e,s)=>{const r=function(e,t={}){let n=t;for(let t=0;t<e.length;t++){if(!n||"object"!=typeof n)return;n=n[e[t]]}if("string"==typeof n||"number"==typeof n)return n;return}(e,t.content);return n=function(e,t){if(e===t)return!0;if("string"!=typeof e||"string"!=typeof t)return!1;try{return function(e,t){return Math.hypot(e[3]*e[0]-t[3]*t[0],e[3]*e[1]-t[3]*t[1],e[3]*e[2]-t[3]*t[2],255*e[3]-255*t[3])<48}((0,o.parseRgba)(e),(0,o.parseRgba)(t))}catch(e){}return!1}(s,r),!n})),n}function C(e,t,n){for(const s in e)if(e.hasOwnProperty(s)){const o=t.concat(s);if("object"==typeof e[s])C(e[s],o,n);else if(n(o,e[s]))throw new Error("exit")}}},61499:(e,t,n)=>{var s;n.d(t,{StdTheme:()=>s}),function(e){e.Light="light",e.Dark="dark"}(s||(s={}))},944454:(e,t,n)=>{var s;n.d(t,{ConnectionStatus:()=>s}),function(e){e[e.Closed=0]="Closed",e[e.Connecting=1]="Connecting",e[e.Open=2]="Open"}(s||(s={}))},368654:(e,t,n)=>{n.d(t,{PersistentEventSourceTransport:()=>i});var s=n(944454),o=n(440150);const r=(0,n(201089).getLogger)("PersistentWebsocketTransport");class i extends o.PersistentTransport{constructor(e){super(e,r),this._specializedErrorHandlerBound=this._specializedErrorHandler.bind(this)}_createNativeTransport(e){const t=new EventSource(e,{withCredentials:!0});return t.addEventListener("error",this._specializedErrorHandlerBound),t.addEventListener("open",this._socketOpenHandler),t.addEventListener("message",this._socketMessageHandler),t}_disconnectTransport(){if(null===this._socket)return;this._socket.removeEventListener("error",this._specializedErrorHandlerBound),this._socket.removeEventListener("open",this._socketOpenHandler),this._socket.removeEventListener("message",this._socketMessageHandler),this._removeOnOfflineListener();const e=this._socket;this._socket=null,this._connectionStatus.setValue(s.ConnectionStatus.Closed),e.readyState!==WebSocket.CLOSED&&e.close()}_specializedErrorHandler(e){e.eventPhase===EventSource.CLOSED?this._socketCloseHandler(e):this._socketErrorHandler()}}},440150:(e,t,n)=>{n.d(t,{PersistentTransport:()=>c});var s=n(944454),o=n(978137),r=n(129025),i=n(707957),a=n(266325);class c{constructor(e,t,n){this._url="",this._socket=null,this._reconnectCount=0,this._onlineCancellationToken=null,this._connectionStatus=new r.WatchedValue(s.ConnectionStatus.Closed),this._socketCloseHandler=this._onCloseCallback.bind(this),this._socketErrorHandler=this._onErrorCallback.bind(this),
this._socketOpenHandler=this._onOpenCallback.bind(this),this._socketMessageHandler=this._onMessageCallback.bind(this),this._maxReconnectReachedEventDelegate=new i.Delegate,this._successReconnectReachedEventDelegate=new i.Delegate,this._shouldReconnect=!0,this._maxReconnectCount=null,this._reconnectTimeoutId=0,this._connectAbortController=null,this._tryReconnect=()=>{if(this._disconnect(),this._shouldReconnect){const e=this._getReconnectTimeout();this._logger.logNormal(`Sleeping some time before reconnect ${e}ms`),this._reconnectTimeoutId=setTimeout(this._tryReconnectImpl.bind(this),e)}else this._logger.logNormal("Skip reconnecting because of shouldReconnect state")},this._onOfflineHandler=()=>{this._removeOnOfflineListener(),this._logger.logInfo("Network status changed to offline - trying to reconnect"),this._tryReconnect()},this._logger=t,this._messageHandler=e,this._closeHandler=n,window.addEventListener("unload",(()=>{t.logNormal("Unload event comes - disconnecting without reconnect after that..."),this._shouldReconnect=!1,this._disconnect()}),!1)}setUrl(e){if(this._url===e)return Promise.resolve();const t=this._connectionStatus.value()!==s.ConnectionStatus.Closed;return t&&this._disconnect(),this._url=e,t?this.connect():Promise.resolve()}url(){return this._url}connect(){return this._connectImpl()}setMaxReconnectCount(e){this._maxReconnectCount=e}connectionStatus(){return this._connectionStatus.readonly()}disconnect(){this._shouldReconnect=!1,this._disconnect()}maxReconnectReachedEvent(){return this._maxReconnectReachedEventDelegate}successReconnectReachedEvent(){return this._successReconnectReachedEventDelegate}async _prepareParamsForConnection(e){}_disconnect(){var e;null===(e=this._connectAbortController)||void 0===e||e.abort(),this._connectAbortController=null,clearTimeout(this._reconnectTimeoutId),this._reconnectTimeoutId=0,this._connectionStatus.value()!==s.ConnectionStatus.Closed?this._socket?(this._logger.logNormal(`Closing connection to: ${this._socket.url}, currentStatus: ${s.ConnectionStatus[this._connectionStatus.value()]}`),this._disconnectTransport()):this._logger.logNormal("Disconnecting without socket - probably within preparing, it should be already scheduled for aborting"):this._logger.logNormal("Attempt to close connection but it is closed already")}_onErrorCallback(){this._logger.logInfo("Connection is closed by error"),this._tryReconnect()}_onCloseCallback(e){var t;this._logger.logInfo(`Connection is closed - code=${e.code} msg=${e.reason}`),null===(t=this._closeHandler)||void 0===t||t.call(this,e),this._tryReconnect()}_tryReconnectImpl(){return null!==this._maxReconnectCount&&this._reconnectCount===this._maxReconnectCount?(this._logger.logWarn("Maximum attempts to reconnect to websocket reached"),void this._maxReconnectReachedEventDelegate.fire()):(this._reconnectCount+=1,this._logger.logInfo(`Reconnecting count: ${this._reconnectCount}`),navigator.onLine?(this._logger.logInfo("Network status: online - trying to connect"),
void this.connect()):(this._logger.logInfo("Network status: offline - wait until online"),void(this._onlineCancellationToken=(0,o.callWhenOnline)((()=>{this._logger.logInfo("Network status changed to online - trying to connect"),this.connect()})))))}_onOpenCallback(){this._logger.logNormal("Connection opened"),this._reconnectCount>0&&this._successReconnectReachedEventDelegate.fire(),this._reconnectCount=0,this._connectionStatus.setValue(s.ConnectionStatus.Open)}_onMessageCallback(e){this._messageHandler(e.data)}_getReconnectTimeout(){return this._reconnectCount<5?300:5e3}_setOnOfflineListener(){window.addEventListener("offline",this._onOfflineHandler)}_removeOnOfflineListener(){window.removeEventListener("offline",this._onOfflineHandler)}async _connectImpl(){if(this._connectionStatus.value()!==s.ConnectionStatus.Closed)return void this._logger.logNormal("Attempt to open connection but it is not closed");this._socket&&(this._logger.logError("Something went wrong - code 0x2"),this.disconnect()),this._onlineCancellationToken&&(this._onlineCancellationToken(),this._onlineCancellationToken=null),this._logger.logNormal(`Connecting to ${this._url}`),this._shouldReconnect=!0,this._connectAbortController=new AbortController;const e=this._connectAbortController.signal;try{if(this._connectionStatus.setValue(s.ConnectionStatus.Connecting),await this._prepareParamsForConnection(e),e.aborted)throw(0,a.createAbortError)();this._socket=this._createNativeTransport(this._url),this._setOnOfflineListener()}catch(e){this._connectionStatus.setValue(s.ConnectionStatus.Closed),(0,a.skipAbortError)(e)}finally{this._connectAbortController=null}}}},774965:(e,t,n)=>{n.d(t,{PersistentWebsocketTransport:()=>a});var s=n(201089),o=n(944454),r=n(440150);const i=(0,s.getLogger)("PersistentWebsocketTransport");class a extends r.PersistentTransport{constructor(e,t){super(e,i,t)}sendMessage(e){this._connectionStatus.value()===o.ConnectionStatus.Open?this._socket?this._socket.send(e):i.logError("Something went wrong - code 0x3"):i.logWarn("Attempt to send message but connection is not opened")}_createNativeTransport(e){const t=new WebSocket(e);return t.binaryType="arraybuffer",t.addEventListener("error",this._socketErrorHandler),t.addEventListener("close",this._socketCloseHandler),t.addEventListener("open",this._socketOpenHandler),t.addEventListener("message",this._socketMessageHandler),t}_disconnectTransport(){if(null===this._socket)return;this._socket.removeEventListener("error",this._socketErrorHandler),this._socket.removeEventListener("close",this._socketCloseHandler),this._socket.removeEventListener("open",this._socketOpenHandler),this._socket.removeEventListener("message",this._socketMessageHandler),this._removeOnOfflineListener();const e=this._socket;this._socket=null,this._connectionStatus.setValue(o.ConnectionStatus.Closed),e.readyState!==WebSocket.CLOSED&&e.close()}}},978137:(e,t,n)=>{n.d(t,{callWhenOnline:()=>o,waitForOnline:()=>r});var s=n(266325);function o(e){let t=e;const n=()=>{window.removeEventListener("online",n),t&&t()}
;return window.addEventListener("online",n),()=>{t=null}}async function r(e=null){return!0===navigator.onLine||void 0===navigator.onLine?Promise.resolve():(0,s.respectAbort)(e,new Promise((e=>{const t=()=>{window.removeEventListener("online",t),e()};window.addEventListener("online",t)})))}}}]);