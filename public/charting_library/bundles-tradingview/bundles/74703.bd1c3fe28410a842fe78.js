"use strict";(self.webpackChunktradingview=self.webpackChunktradingview||[]).push([[74703],{651067:(t,e,s)=>{s.d(e,{getListSymbolsByColor:()=>c,getMarkedListByColor:()=>l,getMarkedLists:()=>n});var o=s(377145),r=s(296890),i=s(546079),a=s(56899);const n=(0,o.createSelector)([i.getMarkedListsState],(t=>{const e=[];if(null!==t)for(const s of r.LIST_COLORS){const o=(0,r.getListByColor)(t,s);null!==o&&e.push((0,a.makeMarkedListFromRecord)(o))}return e})),l=(0,o.createSelector)([i.getMarkedListsState,(t,e)=>e],((t,e)=>{if(null===t)return null;const s=(0,r.getListByColor)(t,e);return null===s?null:(0,a.makeMarkedListFromRecord)(s)})),c=(0,o.createSelector)([l],(t=>{var e;return null!==(e=null==t?void 0:t.symbols)&&void 0!==e?e:null}))},56899:(t,e,s)=>{s.d(e,{getColoredListTitle:()=>i,getSortByColorComparator:()=>n,makeMarkedListFromRecord:()=>a});var o=s(296890),r=s(444372);function i(t){return{[o.ListColor.Red]:r.t(null,void 0,s(97525)),[o.ListColor.Green]:r.t(null,void 0,s(971464)),[o.ListColor.Orange]:r.t(null,void 0,s(141393)),[o.ListColor.Purple]:r.t(null,void 0,s(53171)),[o.ListColor.Blue]:r.t(null,void 0,s(992447)),[o.ListColor.Cyan]:r.t(null,void 0,s(240527)),[o.ListColor.Pink]:r.t(null,void 0,s(816786))}[t]}function a(t){return{type:"colored",id:t.color,color:t.color,symbols:t.symbols,name:t.name||i(t.color),description:t.description,shared:t.shared}}function n(t){const e=-1===t?-1/0:1/0;return(s,o)=>{const r=l(s,e),i=l(o,e);return r===i?0:t*(r-i)}}function l(t,e){return null===t?e:o.LIST_COLORS.indexOf(t)}},776324:(t,e,s)=>{s.d(e,{changeDescription:()=>f,create:()=>h,createCrossTabSyncMiddleware:()=>g,exact:()=>m,exclude:()=>p,getListById:()=>E,getListIds:()=>v,getListsMap:()=>T,insert:()=>d,put:()=>b,reducer:()=>I,remove:()=>y,rename:()=>_,replace:()=>S,setup:()=>u,share:()=>L});var o=s(826300),r=s(199669),i=s(340958),a=s(559986);const n={lists:{ids:[],byId:{}},timestamp:null};function l(t,e){t.lists.ids.push(e.id),t.lists.byId[e.id]={id:e.id,name:e.name,description:e.description,symbols:[...e.symbols],shared:e.shared,timestamp:e.timestamp,collapsedSeparators:e.collapsedSeparators}}const c=(0,o.createSlice)({name:"custom-lists",initialState:n,reducers:{setup:(t,e)=>{const{lists:s,timestamp:o}=e.payload,r={lists:{ids:[],byId:{}},timestamp:null};for(const t of s)l(r,t);return r.timestamp=o,r},insert:(t,e)=>{const{id:s,symbols:o,before:r}=e.payload,{lists:n}=t,l=n.byId[s];if(void 0===l)return;const c=new Set(o);let u;if(void 0!==r&&c.has(r)){u=a.LIST_START;for(let t=l.symbols.indexOf(r);t>=0;--t)if(!c.has(l.symbols[t])){u=l.symbols[t];break}}const d=l.symbols.filter((t=>!c.has(t))),S=(0,a.getTargetIndex)(d,r,u);void 0===S?d.push(...c):d.splice(S,0,...c),(0,i.equalArrays)(d,l.symbols)||(l.symbols=d)},replace:(t,e)=>{const{id:s,current:o,next:r}=e.payload,{lists:i}=t,a=i.byId[s];if(void 0===a)return;if(o===r)return;let n=!1,l=!1;const c=[];for(const t of a.symbols){if(t===r){l=!0;break}t===o?(c.push(r),n=!0):c.push(t)}n&&!l&&(a.symbols=c)},exact:(t,e)=>{const{id:s,symbols:o}=e.payload,{lists:r}=t,a=r.byId[s]
;if(void 0===a)return;const n=[...new Set(o)];(0,i.equalArrays)(n,a.symbols)||(a.symbols=n)},exclude:(t,e)=>{const{id:s,symbols:o}=e.payload,{lists:r}=t,a=r.byId[s];if(void 0===a)return;const n=new Set(o),l=a.symbols.filter((t=>!n.has(t)));(0,i.equalArrays)(l,a.symbols)||(a.symbols=l)},remove:(t,e)=>{const{id:s}=e.payload,{lists:o}=t;if(void 0===o.byId[s])return;const r=o.ids.filter((t=>t!==s));o.ids=r,delete o.byId[s]},create:(t,e)=>{const{id:s,name:o,symbols:r}=e.payload,{lists:i}=t;void 0===i.byId[s]&&l(t,{id:s,name:o,symbols:r,shared:!1,description:null,timestamp:null})},put:(t,e)=>{const{id:s,name:o,description:r,symbols:i,shared:a,timestamp:n,collapsedSeparators:c}=e.payload,{lists:u}=t;void 0===u.byId[s]?l(t,{id:s,name:o,description:r,symbols:i,shared:a,timestamp:null!=n?n:null}):u.byId[s]={id:s,name:o,description:r,shared:a,timestamp:null!=n?n:null,symbols:[...i],collapsedSeparators:c}},rename:(t,e)=>{const{id:s,name:o}=e.payload,{lists:r}=t,i=r.byId[s];void 0!==i&&i.name!==o&&(i.name=o)},changeDescription:(t,e)=>{const{id:s,description:o}=e.payload,{lists:r}=t,i=r.byId[s];void 0!==i&&i.description!==o&&(i.description=o)},share:(t,e)=>{const{id:s,shared:o}=e.payload,{lists:r}=t,i=r.byId[s];void 0!==i&&i.shared!==o&&(i.shared=o)}}}),{setup:u,insert:d,replace:S,exact:m,exclude:p,remove:y,create:h,put:b,rename:_,changeDescription:f,share:L}=c.actions,{reducer:I}=c;function g(t,e,s=c){return(0,r.createCrossTabSyncMiddleware)({id:t,channel:e,event:"custom-list-cross-tab-sync",filter:t=>function(t,e){return e.actions.setup.match(t)||e.actions.insert.match(t)||e.actions.exclude.match(t)||e.actions.exact.match(t)||e.actions.replace.match(t)||e.actions.remove.match(t)||e.actions.create.match(t)||e.actions.put.match(t)||e.actions.rename.match(t)||e.actions.changeDescription.match(t)||e.actions.share.match(t)}(t,s)})}function T(t){return t.lists.byId}function E(t,e){var s;return null!==(s=T(t)[e])&&void 0!==s?s:null}function v(t){return t.lists.ids}},722840:(t,e,s)=>{s.d(e,{quoteSessionAdapters:()=>S});var o=s(650151),r=s(876332),i=s(59171),a=s(946213),n=s(406103),l=s(833813),c=s(740254),u=s(837657);class d{constructor(t,e,s="watchlist"){this._symbolDataHandlers=new Map,this._fastSymbols=new Set,this._subscribedSymbols=new Set,this._subscriptionSet=new Set,this._cancelSubscriptionSet=new Set,this._quoteSessionDataHandler=t=>{const e=(0,o.ensureDefined)(t.symbolname),{filtered:s,keepSubscription:r}=this._applyDataFilters(t);r||this._unsubscribeSymbols([e]),this._setSymbolDataCache(e,s);const i=this._symbolDataHandlers.get(e);i&&i(s)},this._clientId=t,this._quoteSession=(0,r.getQuoteSessionInstance)(s),this._lastSymbolData=e||new Map}destroy(){const t=Array.from(this._subscribedSymbols);this._unsubscribeSymbols(t)}addFastSymbol(t){this._fastSymbols.has(t)||!this._subscribedSymbols.has(t)||(0,u.isSeparatorItem)(t)||(this._fastSymbols.add(t),this._quoteSession.setFastSymbols(this._clientId,Array.from(this._fastSymbols)))}removeFastSymbol(t){this._fastSymbols.has(t)&&(this._fastSymbols.delete(t),
this._quoteSession.setFastSymbols(this._clientId,Array.from(this._fastSymbols)))}addSymbolDataHandler(t,e){(0,u.isSeparatorItem)(t)||this._symbolDataHandlers.set(t,e)}removeSymbolDataHandler(t){this._symbolDataHandlers.delete(t)}addToSubscriptionSet(t){t.forEach((t=>{(0,u.isSeparatorItem)(t)||this._subscriptionSet.add(t)}))}clearSubscriptionSet(){this._subscriptionSet.clear()}addToCancelSubscriptionSet(t){t.forEach((t=>{(0,u.isSeparatorItem)(t)||this._cancelSubscriptionSet.add(t)}))}commitSubscriptionChanges(){Array.from(this._subscriptionSet).forEach((t=>{this._cancelSubscriptionSet.has(t)&&(this._subscriptionSet.delete(t),this._cancelSubscriptionSet.delete(t))})),this._subscribeSymbols(Array.from(this._subscriptionSet)),this._subscriptionSet.clear(),this._unsubscribeSymbols(Array.from(this._cancelSubscriptionSet)),this._cancelSubscriptionSet.clear(),this._quoteSession.setFastSymbols(this._clientId,Array.from(this._fastSymbols))}getLastSymbolData(t){return this._lastSymbolData.get(t)}_subscribeSymbols(t){this._quoteSession.subscribe(this._clientId,t,this._quoteSessionDataHandler),t.forEach((t=>this._subscribedSymbols.add(t)))}_unsubscribeSymbols(t){this._quoteSession.unsubscribe(this._clientId,t,this._quoteSessionDataHandler),t.forEach((t=>{this._subscribedSymbols.delete(t)}))}_setSymbolDataCache(t,e){var s;const o=(null===(s=this._lastSymbolData.get(t))||void 0===s?void 0:s.values)||{};this._lastSymbolData.set(t,{...e,values:{...o,...e.values}})}_applyDataFilters(t){{const e=()=>(0,c.enabled)(l.ProductFeatures.IDC_AVAILABLE_DELAY),s=t=>({...t,status:"sf_data",values:{}});if((t=>(0,a.isSfQuoteData)(t)||(0,n.isIDCExchange)((0,i.getExchange)((0,o.ensureDefined)(t.symbolname)),!0))(t)&&!e())return{filtered:s(t),keepSubscription:!1}}return{filtered:t,keepSubscription:!0}}}const S=new class{constructor(){this._adaptersMap=new Map,this._lastSymbolData=new Map}destroy(){this._adaptersMap.forEach((t=>{t.forEach((t=>t.destroy()))})),this._lastSymbolData.clear()}get(t,e="watchlist"){let s;const o=this._adaptersMap.get(t);if(o){const r=o.get(e);r?s=r:(s=new d(t,this._lastSymbolData,e),o.set(e,s))}else{s=new d(t,this._lastSymbolData,e);const o=new Map;o.set(e,s),this._adaptersMap.set(t,o)}return s}}},850935:(t,e,s)=>{s.r(e),s.d(e,{addOrUpdateSymbolList:()=>u,initWidget:()=>a,removeSymbolList:()=>d,selectAllSymbols:()=>c,selectHotlist:()=>m,selectNextAvailableSymbol:()=>r,setSymbolLists:()=>S,showContextMenu:()=>i,updateActiveList:()=>h,updateBulkPositions:()=>y,updatePosition:()=>p,updateWidget:()=>n,updateWidgetOptions:()=>l});var o=s(189086);const r=(t,e,s,r)=>({type:o.SELECT_NEXT_AVAILABLE_SYMBOL,widgetId:t,currentSymbol:e,keyboardAction:s,cancelSetOnChart:r}),i=(t,e,s,r)=>({type:o.SHOW_CONTEXT_MENU,symbol:e,position:b(s),widgetId:t,size:r}),a=(t,e,s,r)=>({type:o.INIT_WIDGET,options:r,id:t,columns:s,tickerType:e}),n=(t,e)=>({type:o.UPDATE_WIDGET,widgetId:t,widget:e}),l=(t,e)=>({type:o.UPDATE_WIDGET_OPTIONS,widgetId:t,options:e}),c=t=>({type:o.SELECT_ALL_SYMBOLS,widgetId:t}),u=t=>({type:o.ADD_OR_UPDATE_SYMBOL_LIST,
symbolList:t}),d=t=>({type:o.REMOVE_SYMBOL_LIST,id:t}),S=t=>({type:o.SET_SYMBOL_LISTS,symbolLists:t}),m=(t,e,s)=>({type:o.SELECT_HOTLIST,widgetId:t,exchange:e,group:s}),p=(t,e)=>({type:o.UPDATE_POSITIONS,symbol:t,position:e}),y=t=>({type:o.UPDATE_BULK_POSITIONS,map:t}),h=t=>({type:o.UPDATE_ACTIVE_LIST,id:t});function b(t){var e;const s=null===(e=t.touches)||void 0===e?void 0:e.map((t=>({clientX:t.clientX,clientY:t.clientY})));return{clientX:t.clientX,clientY:t.clientY,touches:s,attachToXBy:t.attachToXBy,attachToYBy:t.attachToYBy,box:t.box}}},217525:(t,e,s)=>{s.d(e,{SET_IS_AUTHENTICATED:()=>a,authReducer:()=>l,watchAuth:()=>c});var o=s(254773),r=s(336349),i=s(776324);const a="AUTH__SET_IS_AUTHENTICATED";function n(t){return{type:a,isAuthenticated:t}}function l(t=Boolean(window.is_authenticated),e){return e.type===a?e.isAuthenticated:t}function*c(){const t=(0,o.eventChannel)((t=>{const e={};return window.loginStateChange.subscribe(e,(()=>t(window.is_authenticated))),()=>window.loginStateChange.unsubscribeAll(e)}));try{for(;;){const e=yield(0,r.take)(t);yield(0,r.put)((0,i.setup)({lists:[],timestamp:Date.now(),silent:!0})),yield(0,r.put)(n(e))}}finally{t.close()}}},452528:(t,e,s)=>{s.d(e,{collapsedSeparatorsSelector:()=>l,displaySymbolsSelector:()=>m,displaySymbolsToActualSelector:()=>p,getCurrentViewableCollapsedSeparatorsSelector:()=>c,globalActiveSymbolListDisplaySymbolsSelector:()=>S,separatorIsCollapsedByListIdSelector:()=>d,separatorIsCollapsedSelector:()=>u,symbolsToSeparatorChildrenMap:()=>h});var o=s(377145),r=s(650151),i=s(15814),a=s(456746);const n=(t,e,s)=>s;function l(t){return t.collapsedSeparators}const c=(0,o.createSelector)([l,i.getCurrentViewableWatchListByWidgetId],((t,e)=>e?{...t[e.id]}:{})),u=(0,o.createSelector)([c,n],((t,e)=>b(t,e))),d=(0,o.createSelector)([l,(t,e)=>e,n],((t,e,s)=>b({...t[e]},s))),S=(0,o.createSelector)([l,i.getGlobalActiveSymbolList],((t,e)=>e?y(e,{...t[e.id]}):[])),m=(0,o.createSelector)([i.getCurrentViewableWatchListByWidgetId,c],y),p=(0,o.createSelector)([i.getCurrentViewableWatchListByWidgetId,c,n],((t,e,s)=>{if(!t)return[];const{symbols:o}=t,r=h(o),i=[];return s.forEach((t=>{i.push(t);const s=r.get(t),o=b(e,t);s&&o&&i.push(...s)})),i}));function y(t,e){if(!t)return[];const{symbols:s}=t,o=[];let r=!0;return s.forEach((t=>{const s=(0,a.isValidSeparatorItem)(t);(r||s)&&o.push(t),s&&(r=!b(e,t))})),o}function h(t){const e=new Map;let s="";return t.forEach((t=>{(0,a.isValidSeparatorItem)(t)?(s=t,e.set(s,[])):s&&(0,r.ensureDefined)(e.get(s)).push(t)})),e}function b(t,e){return!!t.hasOwnProperty(e)&&t[e]}},934011:(t,e,s)=>{s.d(e,{createCrossTabSyncMiddleware:()=>u,reducer:()=>c,setSeparatorsCollapse:()=>l});var o=s(826300),r=s(199669),i=s(776324),a=s(296890);const n=(0,o.createSlice)({name:"collapsed-separators",initialState:{},reducers:{setSeparatorsCollapse:(t,e)=>{const{listId:s,values:o}=e.payload;Object.entries(o).forEach((([e,o])=>d(t,s,e,o)))}},extraReducers:t=>{t.addCase(i.setup,S),t.addCase(a.setup,S),t.addCase(i.put,((t,e)=>{m(t,e.payload)})),
t.addCase(a.renameSeparator,((t,e)=>{var s;const{color:o,separator:r,name:i}=e.payload;Boolean(null===(s=t[o])||void 0===s?void 0:s[r])&&d(t,o,i,!0)}))}}),{setSeparatorsCollapse:l}=n.actions,{reducer:c}=n;function u(t,e,s=n){return(0,r.createCrossTabSyncMiddleware)({id:t,channel:e,event:"collapsed-separators-cross-tab-sync",filter:t=>function(t,e){return e.actions.setSeparatorsCollapse.match(t)}(t,s)})}function d(t,e,s,o){t.hasOwnProperty(e)||(t[e]={}),o?t[e][s]=o:delete t[e][s]}function S(t,e){const{lists:s}=e.payload;s.forEach((e=>m(t,e)))}function m(t,e){const s=function(t){return t.hasOwnProperty("color")}(e)?e.color:e.id,{collapsedSeparators:o}=e;t[s]={},null==o||o.forEach((e=>{t[s][e]=!0}))}},189086:(t,e,s)=>{s.d(e,{ADD_OR_UPDATE_SYMBOL_LIST:()=>S,INIT_WIDGET:()=>n,REMOVE_SYMBOL_LIST:()=>p,SELECT_ALL_SYMBOLS:()=>d,SELECT_HOTLIST:()=>y,SELECT_NEXT_AVAILABLE_SYMBOL:()=>r,SET_SYMBOL_LISTS:()=>m,SHOW_CONTEXT_MENU:()=>l,UPDATE_ACTIVE_LIST:()=>h,UPDATE_BULK_POSITIONS:()=>a,UPDATE_POSITIONS:()=>i,UPDATE_WIDGET:()=>c,UPDATE_WIDGET_OPTIONS:()=>u});const o=(0,s(66889).createActionTypeFactory)("WATCHLISTS"),r=o("SELECT_NEXT_AVAILABLE_SYMBOL"),i=o("UPDATE_POSITIONS"),a=o("UPDATE_BULK_POSITIONS"),n=o("INIT_WIDGET"),l=o("SHOW_CONTEXT_MENU"),c=o("UPDATE_WIDGET"),u=o("UPDATE_WIDGET_OPTIONS"),d=o("SELECT_ALL_SYMBOLS"),S=o("ADD_OR_UPDATE_SYMBOL_LIST"),m=o("SET_SYMBOL_LISTS"),p=o("REMOVE_SYMBOL_LIST"),y=o("SELECT_HOTLIST"),h=o("UPDATE_ACTIVE_LIST")},958613:(t,e,s)=>{s.d(e,{createSymbolListId:()=>a,getHotlistById:()=>l,hotListsSelector:()=>n,isHotListId:()=>i});var o=s(377145);const r="###HOT###";function i(t){return"string"==typeof t&&0===t.indexOf(r)}function a(t,e){return r+`${t}.${e}`}const n=t=>{var e,s;return null!==(s=null===(e=t.hotLists)||void 0===e?void 0:e.lists)&&void 0!==s?s:null},l=(0,o.createSelector)([n,(t,e)=>e],((t,e)=>t?t[e]:null))},38506:(t,e,s)=>{s.r(e),s.d(e,{addWatchlistSymbolsThunk:()=>N,createWatchlistThunk:()=>M,getActiveWatchlistThunk:()=>F,getCustomWatchlistsThunk:()=>R,putCustomWatchlistsThunk:()=>P,removeWatchlistSymbolsThunk:()=>Y,removeWatchlistThunk:()=>x,renameSeparatorThunk:()=>H,renameWatchlistThunk:()=>k,replaceWatchlistSymbolsThunk:()=>W,setActiveWatchlistThunk:()=>V,symbolListRepositorySaga:()=>D,validateWatchListSymbols:()=>O});var o=s(336349),r=s(776324),i=s(444372),a=s(564894),n=s(261309),l=s(850935),c=s(201089),u=s(779923),d=s(266325),S=s(15814),m=s(826939),p=s(214168);function*y(){for(yield(0,o.put)((0,p.asAction)(F(null)));;){yield(0,o.take)([r.remove,r.setup]);const t=yield(0,o.select)();null===(0,S.getCurrentViewableListByWidgetId)(t,m.WATCHLIST_WIDGET_ID)&&(yield(0,o.put)((0,p.asAction)(F(null))))}}var h=s(77122),b=s(217525),_=s(387506),f=s(795394),L=s(934011),I=s(833813),g=s(740254),T=s(960337),E=s(440498),v=s(452528);const A=(0,c.getLogger)("Platform.Model.SymbolLists"),C=1e3;function*D(){yield(0,o.fork)(b.watchAuth),h.enabled("widget")||(yield(0,o.fork)(y))}function O(t){return new Promise((e=>{(0,f.resolveSymbolNameForAllDistinct)(t).then((t=>{e(t)}))}))}function w(t){
const e=i.t(null,void 0,s(847746));B(i.t(null,{replace:{number:C.toString()}},s(66596)),e,t)}function B(t,e,o){(0,u.showWarning)({title:e||i.t(null,void 0,s(33115)),text:t},o)}function M(t){const e=(0,a.service)(n.SYMBOL_LIST_REPOSITORY_BACKEND_SERVICE);return async(s,o)=>{try{const o=await e.createWatchList(t);return null===o?null:(s((0,r.create)({id:o.id,name:o.name,symbols:o.symbols})),o.id)}catch(t){return B(t.message),null}}}const R=(0,d.respectLatest)((function(t){const e=(0,a.service)(n.SYMBOL_LIST_REPOSITORY_BACKEND_SERVICE);return async(s,o)=>{try{const o=await(0,d.respectAbort)(t,e.getCustomWatchLists()),i=Date.now();s((0,r.setup)({lists:o.map((t=>({id:t.id,name:t.name,description:t.description,symbols:t.symbols,shared:t.shared,collapsedSeparators:t.collapsedSeparators,timestamp:i}))),timestamp:i}))}catch(t){(0,d.skipAbortError)(t)}}}));function P(t,e){const s=(0,a.service)(n.SYMBOL_LIST_REPOSITORY_BACKEND_SERVICE);return async(o,i)=>{try{const i=await(0,d.respectAbort)(t,s.putWatchList(e));o((0,r.put)({id:i.id,name:i.name,description:i.description,symbols:i.symbols,shared:i.shared,collapsedSeparators:i.collapsedSeparators}))}catch(t){(0,d.rethrowAbortError)(t),B(t.message)}}}function k(t,e,s){const o=(0,a.service)(n.SYMBOL_LIST_REPOSITORY_BACKEND_SERVICE);return async(i,a)=>{i((0,r.rename)({id:e.id,name:s})),await(0,d.respectAbort)(t,o.renameWatchList(e,s))}}function W(t,e,s,o){const i=(0,a.service)(n.SYMBOL_LIST_REPOSITORY_BACKEND_SERVICE);return async(a,n)=>{if("custom"===e.type)if(s.length>C)w(o);else{{const t=(0,S.getCustomListById)(n(),e.id);if((null==t?void 0:t.symbols.length)!==s.length&&!q(s.length))return}a((0,r.exact)({id:e.id,symbols:s})),await(0,d.respectAbort)(t,i.replaceSymbols(e,s))}else A.logWarn("Trying to modify not a custom watchlist")}}function N(t,e,s,o){const i=(0,a.service)(n.SYMBOL_LIST_REPOSITORY_BACKEND_SERVICE);return async(a,n)=>{if("custom"===e.type)if(e.symbols.length>C)w(o);else{{const t=(0,S.getCustomListById)(n(),e.id);if(!(0,E.isDeletedSymbolsList)(e.id)&&(null==t?void 0:t.symbols.length)!==e.symbols.length&&!q(e.symbols.length))return}a((0,r.insert)({id:e.id,symbols:s}));try{await(0,d.respectAbort)(t,i.addSymbols(e,s))}catch(t){if((0,d.isAbortError)(t))throw t;const i=e.symbols.filter((t=>!s.includes(t)));if(a((0,r.exact)({id:e.id,symbols:i})),"ApiError:plan_symbols_limit_reached"===t.name)return void(0,T.createGoProDialog)({feature:"watchlistSymbols"});B(t.message,void 0,o)}}else A.logWarn("Trying to modify not a custom watchlist")}}function Y(t,e,s){const o=(0,a.service)(n.SYMBOL_LIST_REPOSITORY_BACKEND_SERVICE);return async(i,a)=>{i((0,r.exclude)({id:e.id,symbols:s})),await(0,d.respectAbort)(t,o.removeSymbols(e,s))}}function x(t,e){const s=(0,a.service)(n.SYMBOL_LIST_REPOSITORY_BACKEND_SERVICE);return async(o,i)=>{await(0,d.respectAbort)(t,s.removeWatchList(e)),o((0,r.remove)({id:e.id}))}}function V(t,e){const s=(0,a.service)(n.SYMBOL_LIST_REPOSITORY_BACKEND_SERVICE);return async(o,r)=>{o((0,l.updateActiveList)(e)),await(0,d.respectAbort)(t,s.setActive(e))}}
function U(t,e,s){return async(o,i)=>{const a=(0,v.separatorIsCollapsedByListIdSelector)(i(),t,e);o((0,r.replace)({id:t,current:e,next:s})),a&&o((0,L.setSeparatorsCollapse)({listId:t,values:{[s]:!0,[e]:!1}}))}}function H(t,e,s,o){const r=(0,a.service)(n.SYMBOL_LIST_REPOSITORY_BACKEND_SERVICE);return async(i,a)=>{"custom"===e.type?(i(U(e.id,s,o)),await(0,d.respectAbort)(t,r.renameSeparator(e.id,s,o).catch(d.skipAbortError).catch((t=>{B(t.message),i(U(e.id,o,s))})))):A.logWarn("Trying to modify not a custom watchlist")}}const F=(0,d.respectLatest)((function(t){const e=(0,a.service)(n.SYMBOL_LIST_REPOSITORY_BACKEND_SERVICE);return async(s,o)=>{try{const o=await(0,d.respectAbort)(t,e.getActive());if("custom"!==o.type){const e=(0,_.getMarkedSymbolsListServiceInstance)();e.isInited()||await(0,d.respectAbort)(t,new Promise((t=>{e.onInit(t)})))}else"custom"===o.type&&(o.symbols=await(0,d.respectAbort)(t,O(o.symbols))),s((0,r.put)({id:o.id,name:o.name,description:o.description,symbols:o.symbols,shared:o.shared,collapsedSeparators:o.collapsedSeparators}));s((0,l.updateActiveList)("custom"===o.type?o.id:o.color))}catch(t){(0,d.skipAbortError)(t)}}}));function q(t){var e;const s=null===(e=(0,g.getConfig)(I.ProductFeatures.WATCHLIST_SYMBOLS))||void 0===e?void 0:e.limit;return!(s&&t>s)||((0,T.createGoProDialog)({feature:"watchlistSymbols"}),!1)}},214168:(t,e,s)=>{function o(t){return t}s.d(e,{asAction:()=>o})},15814:(t,e,s)=>{s.r(e),s.d(e,{columnsSelector:()=>I,currentHotListSelector:()=>R,getCurrentViewableListByWidgetId:()=>B,getCurrentViewableWatchListByWidgetId:()=>M,getCustomListById:()=>D,getCustomLists:()=>v,getCustomListsMap:()=>C,getCustomListsState:()=>d,getGlobalActiveID:()=>y,getGlobalActiveSymbolList:()=>w,getIsReadyCustomLists:()=>A,getMarkedListsMap:()=>O,highlightedSymbolsSelector:()=>L,isAuthenticatedSelector:()=>S,isLoadingSelector:()=>P,makeGetIsContainedByMultiSelection:()=>W,positionSelector:()=>k,scrollToIdSelector:()=>_,selectedSymbolsSelector:()=>b,shouldDisplayPositionsSelector:()=>E,sortingSelector:()=>f,tickerTypeSelector:()=>g,widgetOptionsSelector:()=>T,widgetSelector:()=>h});var o=s(377145),r=s(650151),i=s(776324),a=s(296890),n=s(546079),l=s(56899),c=s(958613);function u(t){return{type:"custom",id:t.id,name:t.name,description:t.description,symbols:t.symbols,shared:t.shared}}function d(t){return t.customLists}const S=t=>t.isAuthenticated,m=t=>t.widgets,p=(t,e)=>e,y=t=>t.activeSymbolList,h=(0,o.createSelector)([m,p],((t,e)=>t[e]||{})),b=(0,o.createSelector)(h,(t=>t.selectedSymbols||[])),_=(0,o.createSelector)(h,(t=>t.scrollToId)),f=(0,o.createSelector)(h,(t=>t.sorting||null)),L=(0,o.createSelector)(h,(t=>t.highlightedSymbols||null)),I=(0,o.createSelector)(h,(t=>t.columns)),g=(0,o.createSelector)(h,(t=>t.tickerType)),T=(0,o.createSelector)(h,(t=>t.options||{})),E=(0,o.createSelector)([T,S],((t,e)=>t.shouldDisplayPositions&&e)),v=(0,o.createSelector)(d,(t=>(0,i.getListIds)(t).map((e=>u((0,r.ensureNotNull)((0,i.getListById)(t,e))))))),A=(0,o.createSelector)([d],(t=>null!==t.timestamp)),C=(0,
o.createSelector)([d],i.getListsMap),D=(0,o.createSelector)([d,(t,e)=>e],((t,e)=>{const s=(0,i.getListById)(t,e);return null===s?null:u(s)})),O=(0,o.createSelector)([n.getMarkedListsState],(t=>t?t.lists.byColor:null)),w=(0,o.createSelector)([d,n.getMarkedListsState,y],((t,e,s)=>{if(null===s)return null;if(null!==e&&(0,a.isListColor)(s)){const t=(0,a.getListByColor)(e,s);return null===t?null:(0,l.makeMarkedListFromRecord)(t)}{const e=(0,i.getListById)(t,s);return null===e?null:u(e)}})),B=(0,o.createSelector)([c.hotListsSelector,d,n.getMarkedListsState,m,p],((t,e,s,o,r)=>{var n;const d=o[r];if(void 0===d)return null;const S=d.listId;if(null===S)return null;if(null!==s&&(0,a.isListColor)(S)){const t=(0,a.getListByColor)(s,S);return null===t?null:(0,l.makeMarkedListFromRecord)(t)}if((0,c.isHotListId)(S))return null!==(n=null==t?void 0:t[S])&&void 0!==n?n:null;const m=(0,i.getListById)(e,S);return null!==m?u(m):null})),M=(0,o.createSelector)([B],(t=>t&&"hot"!==t.type?t:null));function R(t,e){const s=B(t,e);return"hot"!==(null==s?void 0:s.type)?null:s}const P=(0,o.createSelector)([h,B],((t,e)=>null===e||t.isLoading||!1)),k=(0,o.createSelector)([t=>t.positions,(t,e)=>e],((t,e)=>t[e]));function W(){const t=(0,o.createSelector)([(t,e)=>e.widgetId,t=>t.widgets],((t,e)=>e[t])),e=(0,o.createSelector)(t,(t=>t.selectedSymbols||[])),s=(0,o.createSelector)(e,(t=>new Set(t)));return(0,o.createSelector)([s,(t,e)=>e.symbol],((t,e)=>t.size>1&&t.has(e)))}},456746:(t,e,s)=>{s.d(e,{buildUniqueName:()=>f,canUseMultipleLists:()=>L,compareSymbols:()=>D,convertToSeparatorName:()=>_,createConfirmRemoveText:()=>k,createSaveRenameDialog:()=>g,findNextAvailableSymbol:()=>R,getSymbolFromList:()=>M,getTranslatedListTitle:()=>C,hasDuplicates:()=>B,isEqualRecords:()=>w,isImportDataValid:()=>I,isValidSeparatorItem:()=>h,separatorValToDisplayVal:()=>b,sortSymbols:()=>E,toPositionRecord:()=>O,trackRemoveEvent:()=>P});var o=s(650151),r=s(444372),i=s(77122),a=s(779923),n=s(575816),l=s(722840),c=s(665570),u=s(837657),d=s(173777),S=s(345848),m=s(494966),p=(s(895389),s(56899)),y=s(387506);s(795394);function h(t){return(0,u.isSeparatorItem)(t)}function b(t){return t.replace(d.SEPARATOR_PREFIX,"")}function _(t){return d.SEPARATOR_PREFIX+t}function f(t,e,s=!0){const o=new Set(t),r=s?" 1":"";if(!o.has(e+r))return e+r;let i=2,a="";for(;i<=2e3&&(a=`${e} ${i}`,o.has(a));)i+=1;return a}function L(){return i.enabled("multiple_watchlists")&&window.user&&Boolean(window.user.is_pro)}function I(t){return"string"==typeof t&&!/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F]/.test(t)&&!/^[\r\n\t,]*$/.test(t)}function g(t,e,o){return()=>new Promise((i=>{(0,a.showRename)({title:t,initValue:e,text:r.t(null,void 0,s(83796))+":",maxLength:128,onRename:({newValue:t,dialogClose:e})=>{i(t),e()}},o)}))}function T(t){return t.replace("−","-")}function E(t,e,s,r,i){const a=function(t){const e=[],s=[];t.forEach(((t,e)=>{(0,u.isSeparatorItem)(t)&&s.push(e)}));let o=0;s.forEach((s=>{e.push({values:t.slice(o,s),separator:t[s]}),o=s+1}));const r=s[s.length-1],i=t.slice(r+1);return i.length>0&&e.push({
values:i,separator:null}),e}(e);return a.forEach((e=>{e.values.sort(((e,a)=>{if("flag"===s){const t=(0,y.getMarkedSymbolsListServiceInstance)().getSymbolColor(e),s=(0,y.getMarkedSymbolsListServiceInstance)().getSymbolColor(a);return(0,p.getSortByColorComparator)(r)(t,s)}const u=l.quoteSessionAdapters.get(t).getLastSymbolData(e),d=l.quoteSessionAdapters.get(t).getLastSymbolData(a),S=v(u),h=v(d),b=(t,e)=>{if(!t||"flag"===s)return;var o;return"error"===t.status?void 0:i===n.TickerType.Description&&"short_name"===s?(o=t.values,(0,c.getTranslatedSymbolDescription)(o)||(0,m.safeShortName)(e)):t.values[s]},_=b(u,e),f=b(d,a);return function(t,e){const s=-1===e?-1/0:1/0;return(r,i,a,n)=>{if("rchp"!==t){if(void 0===r&&void 0===i)return 0;if(void 0===r)return-e;if(void 0===i)return e}switch(t){case"short_name":return e*(r===i?0:(0,o.ensure)(r)<(0,o.ensure)(i)?-1:1);case"rchp":return a!==n?a>n?-1:1:(a||(r=void 0),n||(i=void 0),A(r,i,e,s));case"last_price":case"change":case"change_percent":return A(r,i,e,s);case"volume":{const t=(0,o.ensure)(r)>=1e100?s:Number(r),a=(0,o.ensure)(i)>=1e100?s:Number(i);return e*(t-a)}default:return(0,o.ensure)(r)>(0,o.ensure)(i)?-1:1}}}(s,r)(_,f,S,h)}))})),function(t){const e=[];return t.forEach((({values:t,separator:s})=>{e.push(...t),null!==s&&e.push(s)})),e}(a)}function v(t){if(!t)return!1;const e="pre_market"===t.values.current_session,s="post_market"===t.values.current_session;return e||s}function A(t,e,s,o){let r=parseFloat(T(String(t))),i=parseFloat(T(String(e)));return r=isNaN(r)?o:r,i=isNaN(i)?o:i,s*(r-i)}function C(t){return"colored"===t.type?t.name||(0,p.getColoredListTitle)(t.color):t.name}function D(t,e){return t===e||(0,m.safeShortName)(t)===e}function O(t){return{symbol:t.symbol,side:t.side,qty:t.qty,avgPrice:t.avgPrice}}function w(t,e){return t===e||void 0!==t&&void 0!==e&&(t.side===e.side&&t.qty===e.qty&&t.avgPrice===e.avgPrice&&t.symbol===e.symbol)}function B(t){const e=new Map;for(let s=0;s<t.length;s++){const r=t[s].toUpperCase(),i=(0,m.safeShortName)(r);if(e.has(i)){const t=(0,o.ensureDefined)(e.get(i));if(t.has(r)||t.has(i)||r===i)return!0;t.add(r),e.set(i,t)}else e.set(i,new Set([r]))}return!1}function M(t,e){if(e.includes(t))return t}function R(t,e,s){const o="next"===s;for(let s=t;o?s<e.length:s>=0;o?s++:s--)if(!(0,u.isSeparatorItem)(e[s])&&s!==t)return e[s];for(let s=o?0:e.length-1;o?s<t:s>t;o?s++:s--)if(!(0,u.isSeparatorItem)(e[s]))return e[s]}function P(t){t?(0,S.trackEvent)("Watchlist","Multi select","Remove"):(0,S.trackEvent)("Watchlist","Remove")}function k(t){return r.t(null,{plural:"Do you really want to delete {count} selected symbols?",context:"symbols_and_drawings_count",count:t,replace:{count:t.toString()}},s(222045))}},837657:(t,e,s)=>{s.d(e,{isSeparatorItem:()=>r});var o=s(173777);function r(t){return(0,o.isSeparatorItem)(t)}},66889:(t,e,s)=>{function o(t){return e=>t+"__"+e}s.d(e,{createActionTypeFactory:()=>o})}}]);