"use strict";(self.webpackChunktradingview=self.webpackChunktradingview||[]).push([[48158],{552279:(e,t,n)=>{n.d(t,{reloginOrGoPro:()=>h,runOrGoPro:()=>d,runOrGoProWithoutSync:()=>u});var r=n(526225),i=n(960337),o=n(740254),s=n(833813);function a(e,t,n){return t.value||(0,o.enabled)(e,n)}function l(e,t,n){switch(e){case s.ProductFeatures.SCREENER_INTERVALS:return function(e,t){const n=(0,o.getConfig)(s.ProductFeatures.SCREENER_INTERVALS,t);return!(!n||!n.interval)&&n.interval.includes(e.interval)}(t,n);case s.ProductFeatures.SCREENER_AUTO_REFRESH:return a(s.ProductFeatures.SCREENER_AUTO_REFRESH,t,n);case s.ProductFeatures.ALERTS_NO_EXPIRATION:return a(s.ProductFeatures.ALERTS_NO_EXPIRATION,t,n);default:return(0,o.enabled)(e,n)}}var c=n(781666);function u(e,t,n,r){l(t,r)?e():(0,i.createGoProDialog)({...n,runOrGoproWithFeatureCheckOptions:{featureCheck:()=>l(t,r),signInSuccess:e}})}async function d(e,t,n,i={}){const o=window.is_authenticated;window.is_authenticated&&window.user.is_pro&&await(0,r.syncUserData)("gopro"),o===window.is_authenticated?u(e,t,n,i):(0,c.showSignModal)({source:n.goproSource,feature:n.feature,signinSuccess:e})}async function h(e){const t=window.is_authenticated;window.is_authenticated&&window.user.is_pro&&await(0,r.syncUserData)("gopro"),t===window.is_authenticated?(0,i.createGoProDialog)(e):(0,c.showSignModal)({source:e.goproSource,feature:e.feature})}},359663:(e,t,n)=>{n.d(t,{FeatureToggleWatchedValue:()=>o});var r=n(125226),i=n(129025);class o extends i.WatchedValue{constructor(e,t){super(function(e,t){return(0,r.isFeatureEnabled)(e)}(e)),(0,r.onFeaturesStateChanged)().subscribe(this,(t=>{e===t&&this.setValue((0,r.isFeatureEnabled)(e))}))}destroy(){(0,r.onFeaturesStateChanged)().unsubscribeAll(this),super.destroy()}}},526225:(e,t,n)=>{n.r(t),n.d(t,{syncUserConversionData:()=>d,syncUserData:()=>u});var r=n(201089),i=n(345848),o=n(120780),s=n(290576);const a=(0,r.getLogger)("User.Sync");function l(e){return`${e}_${window.user&&window.user.username||""}`}function c(e,t,n,r=!0){n!==window.user.pro_plan&&(window.user.pro_plan=n,window.user.is_pro=Boolean(n),(0,i.trackEvent)("Sync User Data","Different Pro Plan",l(e))),t!==window.is_authenticated&&(window.is_authenticated=t,r&&window.loginStateChange.fire(),(0,i.trackEvent)("Sync User Data","Different Auth",l(e)))}async function u(e){try{c(e,!0,(await(0,s.getProPlanDetailsForUser)()).pro_plan)}catch(t){!function(e,t){403===t.status&&["not_authenticated","login_required"].includes(t.type||"")?c(e,!1,void 0):a.logError(t.message)}(e,t)}}async function d(e,t=!0){var n;const r=new URL("/pricing/",window.location.origin),i=new URLSearchParams(window.location.search);i.has("_test_country")&&r.searchParams.append("_test_country",null!==(n=i.get("_test_country"))&&void 0!==n?n:"");const s=await(0,o.fetch)(r.href),a=await s.json();return c(e,a.is_authenticated,a.user.pro_plan,t),a}},799402:(e,t,n)=>{n.d(t,{AuthToken:()=>a});var r=n(707957),i=n(201089),o=n(120780);const s=(0,i.getLogger)("ChartApi.AuthToken",{color:"#173"});class a{constructor(){
this.invalidated=new r.Delegate,this._tid=0,window.loginStateChange||(window.loginStateChange=new r.Delegate),window.loginStateChange.subscribe(this,(e=>{e||(this._set(window.user.auth_token),this.invalidated.fire())})),this._set(window.user.auth_token)}get(e){return window.is_authenticated?!e&&performance.now()<this._cache.monoValidThru&&Date.now()<this._cache.wallValidThru?(s.logInfo(`Using cached token ${this._cache.token}`),Promise.resolve(this._cache.token)):this._fetch(Boolean(e),0).then((e=>{if(!window.is_authenticated)throw new Error("User logged out while the request was in flight");return this._set(e),e})).catch((e=>(s.logError(`Error fetching new token: ${e&&e.message}`),""))):Promise.resolve("")}reset(){this._set(void 0),this.invalidated.fire()}_set(e){if(window.is_authenticated&&void 0!==e){const t=function(e){if(""===e)return 144e5;try{const t=JSON.parse(atob(e.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"))),n=1e3*(t.exp-t.iat);if(!isFinite(n))throw new Error("invalid expiration");return Math.max(n-3e5,3e5)}catch(t){return s.logError(`${e} is invalid: ${t.message}`),144e5}}(e);this._cache={token:e,monoValidThru:performance.now()+t,wallValidThru:Date.now()+t},clearTimeout(this._tid),this._tid=setTimeout((()=>this.reset()),t),s.logInfo(`Cached for ${t} ms: ${e}`)}else this._cache={token:"",monoValidThru:-1/0,wallValidThru:-1/0},clearTimeout(this._tid),s.logInfo("Cache dropped")}_fetch(e,t){return s.logNormal(`Fetching a new token, grabSession=${e}`),(0,o.fetch)("/quote_token/",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:e?"grabSession=true":""}).then((e=>{if(!e.ok)throw new Error(`Response status is not ok: ${e.status}`);return e.json().then(String)}),(n=>{if(t>=3)throw n;return s.logWarn("Request failed, will retry"),function(e){return new Promise((t=>setTimeout(t,1e3*e)))}(t).then((()=>this._fetch(e,t+1)))}))}}},710056:(e,t,n)=>{var r=n(168647),i=n(725977),o=n(201089).getLogger("Common.CollectionObserver"),s=r.Collection.extend({initialize:function(e,t){if(this._observableCollection=t.observableCollection,this._validator=t.validator,this._syncEvents=i.isArray(t.syncEvents)?t.syncEvents:[],this._syncEvents.push("reset"),this._syncEvents=i.uniq(this._syncEvents),this._observableCollection)if(this._observableCollection instanceof r.Collection){"function"==typeof t.comparator&&(this.comparator=t.comparator),this.comparator||"function"!=typeof this._observableCollection.comparator||(this.comparator=this._observableCollection.comparator),this._observableCollection.on("add",this.onAdd,this),this._observableCollection.on("remove",this.remove,this);for(var n=this._syncEvents.length-1;n>=0;n--)this._observableCollection.on(this._syncEvents[n],this.syncCollections,this);e&&e.length&&this.add(e)}else o.logError("'observableCollection' need to be Backbone.Collection");else o.logError("'observableCollection' option required")},syncCollections:function(){var e=this._validator;e&&this.reset(i.filter(this._observableCollection.models,e))},onAdd:function(e,t,n){
var i=this._validator;if(!i||i(e)){var o=t instanceof r.Collection?n:t;this.add(e,o)}},destroy:function(){this._observableCollection.off("add",this.onAdd,this),this._observableCollection.off("remove",this.remove,this);for(var e=this._syncEvents.length-1;e>=0;e--)this._observableCollection.off(this._syncEvents[e],this.syncCollections,this)}});e.exports=s},394093:(e,t,n)=>{var r;n.d(t,{AlertEditorAbortReason:()=>r}),function(e){e.AlertIsInvalid="alert-is-invalid",e.AlertsMaintenance="alerts-maintenance",e.ChartModelNotFound="chart-model-not-found",e.IsAlreadyPresent="is-already-present",e.MainSeriesIsATR="main-series-is-atr",e.MainSeriesIsInReplay="main-series-is-in-replay",e.MainSeriesIsOffline="main-series-is-offline",e.SourceIsDangerous="source-is-dangerous",e.SymbolInfoTimeout="symbol-info-timeout",e.SymbolIsInvalid="symbol-is-invalid",e.SymbolCurrencyConverted="symbol-currency-converted",e.SymbolUnitConverted="symbol-unit-converted",e.SymbolCurrencyAndUnitConverted="symbol-currency-and-unit-converted",e.SymbolIsEconomics="symbol-is-economics",e.UnsupportedResolution="unsupported-resolution",e.ManualAbort="manual-abort",e.MisleadingPriceScale="misleading-price-scale",e.ResolutionIsTicks="resolution-is-ticks"}(r||(r={}))},862297:(e,t,n)=>{n.d(t,{ensureResolvedSymbolInfo:()=>m,ensureSeriesIsNotOffline:()=>A,getAlertDialogType:()=>_,shouldAbortAlertEditor:()=>v,showAbortExplainingDialog:()=>g});var r=n(444372),i=n(779923),o=n(394093),s=n(444331),a=n(223699),l=n(583912),c=n(537133),u=n(781310),d=n(552279);const h=(0,n(594949).getAlertsTrackers)().maintenance;function _(e){return e.alert?e.type||"edit_alert":"create_alert"}function v(e){var t;if(h.value())return o.AlertEditorAbortReason.AlertsMaintenance;if(!e.alert&&!e.dataSourceHub)return o.AlertEditorAbortReason.ChartModelNotFound;if(!c.alertEditorInvocationHandler.isAllowedToInvoke(e))return o.AlertEditorAbortReason.IsAlreadyPresent;const n=null===(t=e.dataSourceHub)||void 0===t?void 0:t.mainSeries();if(n&&f(n))return o.AlertEditorAbortReason.MainSeriesIsOffline;if(n&&function(e){return 4===e.status()}(n))return o.AlertEditorAbortReason.SymbolIsInvalid;if(n&&n.isConvertedToOtherCurrency()&&n.isConvertedToOtherUnit())return o.AlertEditorAbortReason.SymbolCurrencyAndUnitConverted;if(n&&n.isConvertedToOtherCurrency())return o.AlertEditorAbortReason.SymbolCurrencyConverted;if(n&&n.isConvertedToOtherUnit())return o.AlertEditorAbortReason.SymbolUnitConverted;const r=_(e);if("create_alert"===r&&n&&function(e){const t=e.stateForAlert().styleInputs;return"style"in t&&"ATR"===t.style}(n))return o.AlertEditorAbortReason.MainSeriesIsATR;if("create_alert"===r&&n&&function(e){return e.isInReplay()}(n))return o.AlertEditorAbortReason.MainSeriesIsInReplay;if("create_alert"===r&&n&&function(e){return(0,s.isEconomicSymbol)(e.symbolInfo())}(n))return o.AlertEditorAbortReason.SymbolIsEconomics;const i=n?n.interval():l.linking.interval.value();return"create_alert"===r&&a.Interval.isTicks(i)?o.AlertEditorAbortReason.ResolutionIsTicks:"create_alert"!==r||(0,
u.canPlaceAlertOnResolution)(i)?null:o.AlertEditorAbortReason.UnsupportedResolution}function f(e){return 0===e.status()}function g(e,t){if(p.has(e))return;p.add(e);const s=()=>p.delete(e),a=function(e){return new Map([[o.AlertEditorAbortReason.UnsupportedResolution,"alertsOnSeconds"]]).get(e)||null}(e);if(a)return void(0,d.reloginOrGoPro)({feature:a,actionAfterClose:s});const l=function(e,t){const i=r.t(null,void 0,n(900850)),s=r.t(null,void 0,n(488322)),a=r.t(null,void 0,n(468988));return new Map([[o.AlertEditorAbortReason.AlertsMaintenance,{title:r.t(null,void 0,n(243322)),text:r.t(null,void 0,n(98333)),buttonText:a}],[o.AlertEditorAbortReason.MainSeriesIsOffline,{title:i,text:("create_alert"===t?r.t(null,void 0,n(680644)):r.t(null,void 0,n(878717)))+". "+r.t(null,void 0,n(443167))+".",buttonText:a}],[o.AlertEditorAbortReason.SymbolIsInvalid,{title:i,text:"create_alert"===t?r.t(null,void 0,n(396472)):r.t(null,void 0,n(601230)),buttonText:a}],[o.AlertEditorAbortReason.SymbolCurrencyAndUnitConverted,{title:r.t(null,void 0,n(535871)),text:"create_alert"===t?r.t(null,void 0,n(39546)):r.t(null,void 0,n(588989)),buttonText:r.t(null,void 0,n(875139))}],[o.AlertEditorAbortReason.SymbolCurrencyConverted,{title:r.t(null,void 0,n(203470)),text:"create_alert"===t?r.t(null,void 0,n(499303)):r.t(null,void 0,n(8180)),buttonText:r.t(null,void 0,n(875139))}],[o.AlertEditorAbortReason.SymbolUnitConverted,{title:r.t(null,void 0,n(806212)),text:"create_alert"===t?r.t(null,void 0,n(433335)):r.t(null,void 0,n(615119)),buttonText:r.t(null,void 0,n(875139))}],[o.AlertEditorAbortReason.SymbolIsEconomics,{title:r.t(null,void 0,n(282076)),text:r.t(null,void 0,n(914407)),buttonText:r.t(null,void 0,n(875139))}],[o.AlertEditorAbortReason.MainSeriesIsATR,{title:r.t(null,void 0,n(347599)),text:r.t(null,void 0,n(862688)),buttonText:a}],[o.AlertEditorAbortReason.MainSeriesIsInReplay,{title:r.t(null,void 0,n(198447)),text:r.t(null,void 0,n(881565)),buttonText:r.t(null,void 0,n(875139))}],[o.AlertEditorAbortReason.ResolutionIsTicks,{title:r.t(null,void 0,n(915469)),text:r.t(null,void 0,n(867501)),buttonText:r.t(null,void 0,n(875139))}]]).get(e)||{title:i,text:s,buttonText:a}}(e,t);(0,i.showWarning)({...l,onClose:s})}const p=new Set;function A(e){return new Promise((t=>{if(!f(e))return void t();const n=()=>{f(e)||(e.onStatusChanged().unsubscribe(null,n),t())};e.onStatusChanged().subscribe(null,n)}))}function m(e){return new Promise((t=>{if(e.symbolInfo())return void t();e.dataEvents().symbolResolved().subscribe(null,(()=>{e.symbolInfo()&&t()}),!0)}))}},591427:(e,t,n)=>{n.d(t,{getAlertDescription:()=>o});var r=n(919892),i=n(126290);function o(e){return function(e){return"function"==typeof e.name?e.name():e.name}(e)||function(e){return"description"in e?e.description():e.message}(e)||function(e){const t="function"==typeof e.symbol?(0,r.decodeExtendedSymbol)(e.symbol()):e.symbol,n="function"==typeof e.resolution?e.resolution():e.resolution,o="function"==typeof e.crossInterval?e.crossInterval():e.crossInterval;return(0,i.formatSymbolAndResolution)({
symbol:t,resolution:n,crossInterval:o})}(e)}},537133:(e,t,n)=>{n.d(t,{ALERT_DIALOG_CREATE_INVOCATION_ID:()=>s,alertEditorInvocationHandler:()=>l});var r=n(650151),i=n(129025),o=n(862297);const s=-1;class a{constructor(){this._state=new i.WatchedValue(!1)}subscribe(e){this._state.subscribe(e)}unsubscribe(e){this._state.unsubscribe(e)}value(){return this._state.value()}abort(){this._state.setValue(!0)}}const l=new class{constructor(){this._dialogInvocations=new i.WatchedValue(new Map)}getDialogInvocations(){return this._dialogInvocations}isAllowedToInvoke(e){return e.silent||!this._dialogInvocations.value().has(c(e))}lockInvocation(e){if(e.silent)return{unlockInvocation:()=>{}};const t=c(e),n=new a,r=new Map(this._dialogInvocations.value());return r.set(t,n),this._dialogInvocations.setValue(r),{abortSignal:n,unlockInvocation:()=>{const e=new Map(this._dialogInvocations.value());e.delete(t),this._dialogInvocations.setValue(e)}}}};function c(e){return"create_alert"===(0,o.getAlertDialogType)(e)?s:(0,r.ensureDefined)(e.alert).id}},937994:(e,t,n)=>{function r(e=0){return e<1e3?e:e/1e3}function i(e,t){if(e.length>t){const n=/[\W]+$/g,r=e.substring(0,t),i=r.replace(n,"");return`${i.length?i:r.substring(0,t-1)}…`}return e}n.d(t,{cutString:()=>i,ensureDurationInSeconds:()=>r})},971375:(e,t,n)=>{var r;n.d(t,{AlertsPushStreamMessage:()=>r}),function(e){let t,n,r;!function(e){e.Event="event",e.Running="alert_running",e.Stopped="alert_stopped",e.Deleted="alert_deleted",e.Cloned="new_alerts"}(t=e.Method||(e.Method={})),function(e){e.None="",e.Manual="manual",e.Expired="expired",e.ProPlanExpired="pro_plan_expired",e.Auto="auto",e.Error="error",e.FireControl="fire_control",e.Cloned="cloned",e.StudyPermExpired="study_perm_expired"}(n=e.StopReason||(e.StopReason={})),function(e){e.None="",e.StudyError="study_error",e.ResolveError="resolve_error",e.DrawingIsExpired="drawing_is_expired"}(r=e.Error||(e.Error={}))}(r||(r={}))},695242:(e,t,n)=>{n.d(t,{canPlaceAlertOnResolution:()=>s});var r=n(223699),i=n(740254),o=n(833813);function s(e,t){const n=r.Interval.isSeconds(e),s=t?null==t?void 0:t.alertsOnSeconds:(0,i.enabled)(o.ProductFeatures.ALERTS_ON_SECONDS);return!n||s}},408114:(e,t,n)=>{n.r(t),n.d(t,{ChartAlertsFacadeOld:()=>w});var r=n(130551),i=n(316230),o=n(650151),s=n(707957),a=n(129025),l=n(827523),c=n(826908),u=n(678183),d=n(971375);const h=new WeakMap;class _{constructor(e){var t;this._destroyed=new a.WatchedValue(!1),this._extraUpdated=new s.Delegate,this._onConditionChange=new s.Delegate,this._conditionCache=null,this.destroy=()=>{var e;this._destroyed.setValue(!0),this._hovered.setValue(!1),this._selected.setValue(!1),this._alert.off("destroy",this.destroy),this._alert.off("fired",this._onFired),this._alert.off("change:id",this._onIdChanged),this._alert.off("change:isBeingEdited",this._onisBeingEditedChanged),this._alert.off("change:hovered",this._onHoveredChanged),this._alert.off("change:selected",this._onSelectedChanged),this._alert.off("change:active",this._onActiveChanged),this._alert.off("change:extra",this._onExtraUpdated),
null===(e=this._alert.get("extra"))||void 0===e||e.onConditionChange.unsubscribeAll(this)},this._onIdChanged=(e,t)=>{this._id.setValue(t)},this._onisBeingEditedChanged=(e,t)=>{this._isBeingEdited.setValue(t)},this._onHoveredChanged=(e,t)=>{this._hovered.setValue(t)},this._onSelectedChanged=(e,t)=>{this._selected.setValue(t)},this._onActiveChanged=(e,t)=>{this._active.setValue(t)},this._onFired=()=>{var e;this._localFireTime.setValue(null!==(e=this._alert.get("localFireTime"))&&void 0!==e?e:null)},this._onExtraUpdated=()=>{this._tryRecreateExtra(),this._extraUpdated.fire()},this._onConditionChanged=()=>{const e=this._calcConditionCache();(0,i.default)(this._conditionCache,e)||(this._conditionCache=e,this._onConditionChange.fire())},this._alert=e,this._tryRecreateExtra(),this._id=new a.WatchedValue(e.id),this._isBeingEdited=new a.WatchedValue(e.get("isBeingEdited")),this._hovered=new a.WatchedValue(e.get("hovered")),this._selected=new a.WatchedValue(e.get("selected")),this._active=new a.WatchedValue(e.get("active")),this._localFireTime=new a.WatchedValue(null!==(t=e.get("localFireTime"))&&void 0!==t?t:null),e.on("destroy",this.destroy),e.on("fired",this._onFired),e.on("change:id",this._onIdChanged),e.on("change:isBeingEdited",this._onisBeingEditedChanged),e.on("change:hovered",this._onHoveredChanged),e.on("change:selected",this._onSelectedChanged),e.on("change:active",this._onActiveChanged),e.on("change:extra",this._onExtraUpdated)}alert(){return this._alert}stopReason(){switch(this._alert.get("stopReason")){case d.AlertsPushStreamMessage.StopReason.Auto:return u.AlertStopReason.Auto;case d.AlertsPushStreamMessage.StopReason.Manual:return u.AlertStopReason.Manual;case d.AlertsPushStreamMessage.StopReason.Expired:return u.AlertStopReason.Expired;default:return}}setSelected(e){this._alert.set("selected",e)}title(){return this._alert.title()}name(){return this._alert.get("name")}description(){return this._alert.get("description")}defaultDescription(){return this._alert.defaultDescription()}resetToDefaultDescription(){this._alert.setDefaultDescription()}seriesState(){var e;const t=this._alert.get("extra");return t&&null!==(e=t.alertSeries())&&void 0!==e?e:null}seriesId(){const e=this.seriesState();return e?function(e){return Boolean("fullId"in e&&"inputs"in e&&e.fullId&&e.inputs)}(e)&&e.isTVScript?(0,c.idForAlert)((0,l.extractStudyId)(e.fullId),(0,c.getInputsForAlertId)(e.inputs)):e.id:null}setSeriesState(e){(0,o.ensureDefined)(this._alert.get("extra")).alertSeries(e)}mainSeriesState(){var e;const t=this._alert.get("extra");return t&&null!==(e=t.mainSeries())&&void 0!==e?e:null}setMainSeriesState(e){(0,o.ensureDefined)(this._alert.get("extra")).mainSeries(e)}lineState(){var e;const t=this._alert.get("extra");return t&&null!==(e=t.drawing())&&void 0!==e?e:null}setLineState(e){(0,o.ensureDefined)(this._alert.get("extra")).drawing(e)}symbol(){return this._alert.get("symbolInternal")}setSymbol(e){this._alert.set("symbolInternal",e)}resolution(){return this._alert.get("resolution")}setResolution(e){
this._alert.set("resolution",e)}id(){return this._id.readonly()}isBeingEdited(){return this._isBeingEdited.readonly()}hovered(){return this._hovered.readonly()}selected(){return this._selected.readonly()}active(){return this._active.readonly()}localFireTime(){return this._localFireTime.readonly()}destroyed(){return this._destroyed.readonly()}condition(){return null===this._conditionCache&&(this._conditionCache=this._calcConditionCache()),this._conditionCache}setCondition(e){const t=(0,o.ensureDefined)(this._alert.get("extra"));"channel"===e.type?t.price({upper:e.upper,lower:e.lower}):t.price(e.price)}saveState(){this._alert.saveState()}restoreState(){this._alert.restoreState()}isNew(){return this._alert.isNew()}crossInterval(){return this._alert.get("crossInterval")}isPrice(){return this._alert.isPrice()}isOHLC(){return this._alert.isOHLC()}isRangeBasedStyle(){return this._alert.isRangeBasedStyle()}extraUpdated(){return this._extraUpdated}onConditionChanged(){return this._onConditionChange}static get(e){let t=h.get(e);return void 0===t&&(t=new _(e),h.set(e,t)),t}_tryRecreateExtra(){var e,t;this._alertExtra!==this._alert.get("extra")&&(null===(e=this._alertExtra)||void 0===e||e.onConditionChange.unsubscribeAll(this),this._alertExtra=this._alert.get("extra"),null===(t=this._alertExtra)||void 0===t||t.onConditionChange.subscribe(this,this._onConditionChanged))}_calcConditionCache(){const e=this._alert.get("extra");if(void 0===e)return null;const t=e.comparisonConditionData();if(!t)return null;if(t.isChannel){return{type:"channel",...e.price()}}return{type:"price",price:e.price()}}}var v=n(125226),f=n(710056),g=n.n(f),p=n(781310);const A=(0,v.isFeatureEnabled)("alert_label_inactive");class m{constructor(e,t,n){this._collectionReset=new s.Delegate,this._alertAdded=new s.Delegate,this._alertRemoved=new s.Delegate,this._alertChanged=new s.Delegate,this._onAlertAdded=e=>{this._alertAdded.fire(_.get(e))},this._onAlertRemoved=e=>{this._alertRemoved.fire(_.get(e))},this._onAlertChanged=e=>{this._alertChanged.fire(_.get(e))},this._onCollectionReset=()=>{this._collectionReset.fire()},this._alertsList=new(g())([],{observableCollection:n,syncEvents:["change:active","change:crossInterval","change:resolution","change:symbol"],validator:n=>(A||n.get("active")||n.isNew())&&(0,p.isAlertResolutionEqual)(n,e())&&n.get("symbol")===t()}),this._alertsList.on("add",this._onAlertAdded),this._alertsList.on("remove",this._onAlertRemoved),this._alertsList.on("change:alertSeries",this._onAlertChanged),this._alertsList.on("reset",this._onCollectionReset)}destroy(){this._alertsList.off("add",this._onAlertAdded),this._alertsList.off("remove",this._onAlertRemoved),this._alertsList.off("change:alertSeries",this._onAlertChanged),this._alertsList.off("reset",this._onCollectionReset),this._alertsList.destroy()}alerts(){return this._alertsList.models.map((e=>_.get(e)))}reset(){this._alertsList.reset()}sync(){this._alertsList.syncCollections()}collectionReset(){return this._collectionReset}alertAdded(){return this._alertAdded}alertRemoved(){
return this._alertRemoved}alertChanged(){return this._alertChanged}}var b=n(429589);class w{constructor(e){this._deletingAlerts=new Set,this._dispatcher=e}createCollection(e,t){return new m(e,t,this._dispatcher.alerts)}ensureFullAlertsList(e){return this._dispatcher.ensureFullAlertsList(e)}getAlert(e,t){let n;if(void 0!==t){const e=t.success;n={...t,success:void 0===e?void 0:t=>e(_.get(t))}}this._dispatcher.requestAlert(e,n)}getAlertSync(e){const t=this._dispatcher.getAlertSync(e);return null===t?null:_.get(t)}deleteAlert(e,t){if(this._deletingAlerts.has(e))return;this._deletingAlerts.add(e);const n=(0,r.isObject)(e)?e.alert():e;this._dispatcher.deleteAlert(n,{...t,complete:()=>{var n;this._deletingAlerts.delete(e),null===(n=null==t?void 0:t.complete)||void 0===n||n.call(t)}})}stopAlert(e,t){const n=(0,r.isObject)(e)?e.alert():e;this._dispatcher.stopAlert(n,t)}cloneAlert(e,t){const n=e.alert();let r;if(void 0!==t){const e=t.success;r={...t,success:void 0===e?void 0:t=>{e(_.get(t))}}}this._dispatcher.cloneAlert(n,r)}stopAlerts(e){this._dispatcher.stopAlerts(e)}restartAlerts(e){this._dispatcher.restartAlerts(e)}cloneAlerts(e){this._dispatcher.cloneAlerts(e)}deleteAlerts(e){this._dispatcher.deleteAlerts(e)}restartAllAlerts(e){this._dispatcher.restartAllAlerts(e)}stopAllAlerts(e){this._dispatcher.stopAllAlerts(e)}deleteAllAlerts(e){this._dispatcher.deleteAllAlerts(e)}deleteEvents(e){this._dispatcher.deleteEvents(e)}restartAlert(e,t){let n;if(void 0!==t){const e=t.success;n={...t,success:void 0===e?void 0:t=>e(_.get(t))}}const i=(0,r.isObject)(e)?e.alert():e;this._dispatcher.restartAlert(i,n)}openEditDialog(e,t){const n=(0,r.isObject)(e)?e.alert():e;this._dispatcher.openEditDialog(n,t)}invokeAlertEditor(e){(0,b.invokeAlertEditor)({...e,alert:void 0===e.alert?void 0:e.alert.alert()})}setChartWidgetCollection(e){this._dispatcher.setChartWidgetCollection(e)}removeAlertFromAllChartsSilently(e,t){this._dispatcher.removeAlertFromAllChartsSilently(e,t)}}},678183:(e,t,n)=>{var r;n.d(t,{AlertStopReason:()=>r}),function(e){e[e.Auto=0]="Auto",e[e.Manual=1]="Manual",e[e.Expired=2]="Expired"}(r||(r={}))},193149:(e,t,n)=>{n.d(t,{formatAppendingResolutionString:()=>o});var r=n(731042),i=n(31341);function o(e){const t=(0,r.getTranslatedResolution)(e);return(0,i.isRtl)()?" "+(0,i.forceRTLStr)(" ,"+t):", "+t}},126290:(e,t,n)=>{n.d(t,{formatSymbolAndResolution:()=>a});var r=n(59171),i=n.n(r),o=n(919892),s=n(193149);function a(e,t){const n=function(e,t){let n=(0,o.unwrapSimpleSymbol)(e);t||(n=i().shortName(n));return n}(e.symbol,t);if(e.crossInterval)return n;return n+(0,s.formatAppendingResolutionString)(e.resolution)}},726778:(e,t,n)=>{function r(e){return o().then((t=>t.hasUserAccessToDataSource(e)))}function i(e){return o().then((t=>t.filterAccessibleDataSources(e)))}n.d(t,{filterAccessibleDataSources:()=>i,hasUserAccessToDataSource:()=>r});const o=()=>Promise.all([n.e(68716),n.e(46574),n.e(24028),n.e(87896),n.e(42292),n.e(88124),n.e(44581),n.e(3657),n.e(41339),n.e(73017),n.e(95503),n.e(83441)]).then(n.bind(n,827019))},781310:(e,t,n)=>{
n.d(t,{canPlaceAlertOnResolution:()=>i.canPlaceAlertOnResolution,isAlertResolutionEqual:()=>o,isWidgetAlertResolutionEqual:()=>s});var r=n(223699),i=n(695242);function o(e,t){return e.get("crossInterval")||r.Interval.isEqual(e.get("resolution"),t)}function s(e,t){return e.crossInterval||r.Interval.isEqual(e.resolution,t)}},594949:(e,t,n)=>{n.d(t,{getAlertSession:()=>r.getAlertSession,getAlertsTrackers:()=>i.getAlertsTrackers});var r=n(908287),i=n(206242)},206242:(e,t,n)=>{n.r(t),n.d(t,{getAlertsTrackers:()=>c});var r=n(895171),i=n(359663),o=(n(659863),n(694839)),s=n(129025);class a{constructor(e,t){this._unsetMaintenanceTimeoutId=null,this._onAliveMaintenanceChange=e=>{if(e)this._clearMaintenanceUnsetTimeout(),this._lastMaintenanceUnsetReason=null,this._state.setValue(!0);else if(this._config.autoUnsetMaintenanceTimeout){const e=this._config.autoUnsetMaintenanceTimeout;this._unsetMaintenanceTimeoutId=setTimeout((()=>this._syncMaintenanceState("timeout")),(t=e.from,n=e.to,Math.floor(Math.sqrt(Math.random())*(n-t)+t)))}var t,n},this._maintenanceValue=e,this._config=t,this._state=new s.WatchedValue(this._maintenanceValue.value()),this._lastMaintenanceUnsetReason=this._state.value()?null:"initial_operated",this._maintenanceValue.subscribe(this._onAliveMaintenanceChange)}destroy(){this._clearMaintenanceUnsetTimeout(),this._maintenanceValue.unsubscribe(this._onAliveMaintenanceChange)}value(){return this._state.value()}syncOnUserAction(){this._syncMaintenanceState("user_action")}subscribe(e){this._state.subscribe(e)}unsubscribe(e){this._state.unsubscribe(e)}lastMaintenanceUnsetReason(){return this._lastMaintenanceUnsetReason}_syncMaintenanceState(e){this._clearMaintenanceUnsetTimeout();const t=this._state.value(),n=this._maintenanceValue.value();t!==n&&(this._lastMaintenanceUnsetReason=n?null:"user_action"===e?"user_action":"auto_unset",this._state.setValue(n))}_clearMaintenanceUnsetTimeout(){this._unsetMaintenanceTimeoutId&&(clearTimeout(this._unsetMaintenanceTimeoutId),this._unsetMaintenanceTimeoutId=null)}}class l{constructor(e){this._setOfflineTimeout=null,this._onOnline=()=>{this._clearSetOfflineTimeout(),this._state.setValue(!1)},this._onOffline=()=>{this._setOfflineTimeout=setTimeout((()=>this._syncOfflineState()),1e4)},this._isOffline=e,this._state=new s.WatchedValue(this._isOffline()),window.addEventListener("online",this._onOnline),window.addEventListener("offline",this._onOffline)}value(){return this._state.value()}subscribe(e){this._state.subscribe(e)}unsubscribe(e){this._state.unsubscribe(e)}destroy(){this._clearSetOfflineTimeout(),window.removeEventListener("online",this._onOnline),window.removeEventListener("offline",this._onOffline)}_syncOfflineState(){this._clearSetOfflineTimeout(),this._state.setValue(this._isOffline())}_clearSetOfflineTimeout(){this._setOfflineTimeout&&(clearTimeout(this._setOfflineTimeout),this._setOfflineTimeout=null)}}const c=(0,r.default)((()=>{const e=new i.FeatureToggleWatchedValue("alerts-maintenance",!1),t=(0,o.getAlertConfig)(),n=new a(e,t),r=new l((()=>!window.navigator.onLine))
;return{maintenance:n,offline:r,anyTrackerFired:()=>n.value()||r.value()}}))},582665:(e,t,n)=>{n.d(t,{bulkRemoveConfirmation:()=>l,bulkRemoveInactiveConfirmation:()=>c,bulkRestartConfirmation:()=>a,bulkStopConfirmation:()=>s,selectedRemoveConfirmation:()=>u});var r=n(444372),i=n(591427),o=n(937994);const s=e=>e?{title:r.t(null,void 0,n(742692)),text:r.t(null,void 0,n(528183))}:{title:r.t(null,void 0,n(73016)),text:r.t(null,void 0,n(343860))},a=e=>e?{title:r.t(null,void 0,n(733946)),text:r.t(null,void 0,n(548111))}:{title:r.t(null,void 0,n(639901)),text:r.t(null,void 0,n(530147))},l=e=>e?{title:r.t(null,void 0,n(830930)),text:r.t(null,void 0,n(764123))}:{title:r.t(null,void 0,n(879698)),text:r.t(null,void 0,n(597411))},c=()=>({title:r.t(null,void 0,n(447537)),text:r.t(null,void 0,n(669387))}),u=e=>{if(1!==e.length)return{title:r.t(null,void 0,n(558519)),text:r.t(null,void 0,n(260920))};const t=e[0],s=(0,i.getAlertDescription)(t);return{title:r.t(null,void 0,n(588511)),text:r.t(null,void 0,n(974834)).format({alert:(0,o.cutString)(s,100)})}}},735337:(e,t,n)=>{n.d(t,{showGoProAlertsOnSecondsDialog:()=>i});var r=n(960337);function i(){(0,r.createGoProDialog)({feature:"alertsOnSeconds"})}},526698:(e,t,n)=>{n.d(t,{AggregateError:()=>m,ApiError:()=>A,accumulateErrors:()=>o,changePassword:()=>p,changePasswordUrl:()=>g,checkPhoneCode:()=>c,fetchPost:()=>s,firstLoginData:()=>a,firstLoginDataUrl:()=>i,recoverPassword:()=>w,recoverPasswordUrl:()=>b,recoveryPassword:()=>u,resendLink:()=>l,resetPassword:()=>y,signin:()=>_,signinUrl:()=>d,signup:()=>f,signupUrl:()=>v});var r=n(120780);const i="/accounts/first_login_data/";function o(e,t){return Object.entries(e).map((e=>new A(e[1].join("\n"),t,e[0])))}function s(e,t){return(0,r.fetch)(e,{method:"POST",credentials:"include",mode:"same-origin",body:t})}function a(e){return s(i,e).then((e=>e.ok?e.json():e.json().then((t=>{throw new m(o(t.errors,e.status))}))))}function l(){return s("/api/v1/users/anon/change-email/resend/").then((e=>e.ok?e.json():e.json().then((e=>{throw Error(e.error)}))))}function c(e){return s("/api/v1/recover_password/check_phone_code/",e).then((e=>e.ok?e.json():e.json().then((e=>{throw Error(e.error)}))))}function u(e){return s("/api/v1/recover_password/",e).then((e=>e))}const d="/accounts/signin/";function h(e){return e.json().then((t=>{if("error"in t&&""!==t.error||"code"in t||!e.ok)throw new A(t.error||t.detail,e.status,t.code,t.two_factor_types);return t}))}function _(e){return s(d,e).then(h)}const v="/accounts/signup/";function f(e){return s(v,e).then((e=>e.json().then((t=>{if("errors"in t&&""!==t.errors)throw new m(o(t.errors,e.status))}))))}const g="/api/v1/user/profile/settings/change_password/";function p(e){return s(g,e).then((e=>e))}class A extends Error{constructor(e,t,n,r){super(e),this.type=n,this.status=t,this.secondFactorTypes=r}}class m extends Error{constructor(e){super(e.map((e=>e.message)).join("\n")),this.errors=[],this.errors=e}}const b="/api/v1/recover_password/search/";function w(e){return s(b,e).then(h)}function y(e){
return s("/accounts/reset_password/",e).then((e=>400===e.status?e.json().then((t=>{if("errors"in t)throw new m(o(t.errors,e.status));throw new A(t.detail,e.status,t.code)})):h(e)))}},290576:(e,t,n)=>{n.d(t,{getProPlanDetailsForUser:()=>_,isExpertFeature:()=>h});var r=n(822122),i=n(740254),o=n(255453),s=n(120780),a=n(526698);function l(e){return window.pro?e===r.ProPlans.Free?-1:window.pro.getProduct((0,o.getProductForTrial)(e)).upgrade_weight:0}function c(e){return window.pro?window.pro.getProduct((0,o.getProductForTrial)(e)).upgrade_weight:0}function u(e){return function(e){return e.sort(((e,t)=>l(e)-l(t)))}((0,i.getProPlansWithFeature)(e).filter((e=>!(0,o.isTrialProduct)(e))))[0]||null}function d(e){return function(e){return e.sort(((e,t)=>c(e)-c(t)))}((0,i.getExpertPlansWithFeature)(e))[0]||null}function h(e){const t=d(e),n=u(e);return Boolean(t)&&!Boolean(n)}async function _(){const e=await(0,s.fetch)("/pro-plans/profile/"),t=await e.json();if(e.ok)return t;if(403===e.status){const n=t;throw new a.ApiError(n.detail,e.status,n.code)}throw new Error(`Unable to handle unexpected response: ${String(e.text())}`)}},96080:(e,t,n)=>{function r(e){let t,n=0;if(0===e.length)return n;for(var r=0;r<e.length;r++)t=e.charCodeAt(r),n=(n<<5)-n+t,n&=n;return n}n.r(t),n.d(t,{hash:()=>r})}}]);