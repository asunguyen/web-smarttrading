"use strict";(self.webpackChunktradingview=self.webpackChunktradingview||[]).push([[20645],{429589:(e,t,r)=>{r.r(t),r.d(t,{invokeAlertEditor:()=>A,invokeAlertEditorWithOnlineSeries:()=>g});var o=r(650151),n=r(862297),i=r(949307),a=r(394093),s=r(726778),l=r(201089),c=r(125226),u=r(537133),d=r(206242);const h=(0,l.getLogger)("Alerts.Price.InvokeAlertEditor");function A(e){(0,d.getAlertsTrackers)().maintenance.syncOnUserAction();const t=(0,n.shouldAbortAlertEditor)(e);if(null!==t)return t!==a.AlertEditorAbortReason.IsAlreadyPresent&&(0,n.showAbortExplainingDialog)(t,(0,n.getAlertDialogType)(e)),h.logWarn(`Aborted: ${t}`),void(e.onAborted&&e.onAborted(t));const{unlockInvocation:s,abortSignal:l}=u.alertEditorInvocationHandler.lockInvocation(e);!(0,c.isFeatureEnabled)("alerts-editor-use-facade")||e.silent?Promise.all([Promise.resolve().then(r.bind(r,908287)),Promise.all([r.e(68716),r.e(46574),r.e(16392),r.e(56122),r.e(24028),r.e(25977),r.e(68647),r.e(62750),r.e(42292),r.e(88124),r.e(44581),r.e(3657),r.e(47944),r.e(41339),r.e(73017),r.e(17540),r.e(1335),r.e(38617),r.e(15716),r.e(93202),r.e(60273)]).then(r.t.bind(r,612708,19)),(0,i.getPriceAlertsDispatcher)(),S(e,s,l)]).then((async e=>{const[{getAlertSession:t},{AlertEditor:r},n,i]=e,a=(0,o.ensureNotNull)(t().user.value());await a.twoFactorTracker.sync(),new r(n,i)}),s):Promise.all([Promise.resolve().then(r.bind(r,908287)),Promise.all([r.e(68716),r.e(46574),r.e(16392),r.e(2741),r.e(56122),r.e(39774),r.e(22666),r.e(5993),r.e(62253),r.e(92191),r.e(34465),r.e(32109),r.e(72639),r.e(9817),r.e(69121),r.e(53842),r.e(4015),r.e(92108),r.e(88194),r.e(87845),r.e(89842),r.e(48986),r.e(68992),r.e(93502),r.e(81643),r.e(13152),r.e(36884),r.e(5145),r.e(38669),r.e(84281),r.e(63987),r.e(3436),r.e(73954),r.e(34545),r.e(49205),r.e(6209),r.e(47981),r.e(90592),r.e(60123),r.e(22486),r.e(47047),r.e(89434),r.e(18511),r.e(24028),r.e(26053),r.e(17301),r.e(75058),r.e(52455),r.e(99872),r.e(19512),r.e(50487),r.e(962),r.e(62750),r.e(42292),r.e(88124),r.e(68985),r.e(44581),r.e(3657),r.e(47944),r.e(41339),r.e(73017),r.e(17540),r.e(1335),r.e(38617),r.e(95216),r.e(76317),r.e(15716),r.e(80018),r.e(18118),r.e(93202),r.e(77895)]).then(r.bind(r,370495)),S(e,s,l)]).then((async([{getAlertSession:e},{invokeDialogAlertEditor:t},r])=>{const n=(0,o.ensureNotNull)(e().user.value());await n.twoFactorTracker.sync(),t(r,n)}),s)}function S(e,t,r){return(e.series?(0,s.hasUserAccessToDataSource)(e.series):Promise.resolve(!0)).then((o=>{const{onDestroy:n}=e,i={...e,abortSignal:r,onDestroy:()=>{t(),n&&n()}};return o||(delete i.series,delete i.value),i}))}function g(e){e.dataSourceHub?(0,n.ensureSeriesIsNotOffline)(e.dataSourceHub.mainSeries()).then((()=>{A(e)})):A(e)}},835819:(e,t,r)=>{r.r(t),r.d(t,{initGlobalAlertsHotkeys:()=>l});var o=r(799786),n=r(373017),i=r(617540),a=r(429589),s=r(430159);function l(e){(0,o.createGroup)({desc:"Alerts"}).add({desc:"Create",hotkey:o.Modifiers.Alt+65,handler:()=>{const t=e.activeChartWidget.value(),r=t.hasModel()&&t.model().model();r&&function(e){
const{dataSourceHub:t,shouldReturnFocus:r,analyticsData:{goProSource:o,goProSourceMeta:l,actionSource:c,featureLocation:u}}=e,d={dataSourceHub:t,actionSource:c,featureLocation:u,shouldReturnFocus:r},h={source:o,sourceMeta:l,feature:"alert"},A=t.crossHairSource();A.isOnHoveredChartWidget()&&(d.value=A.price);const S=t.selection().dataSources();if(1!==(null==S?void 0:S.length))return void(0,s.runOrSigninWithFeature)((()=>(0,a.invokeAlertEditorWithOnlineSeries)(d)),h);const g=S[0];if((0,n.isStudy)(g))return d.series=g,void(0,s.runOrSigninWithFeature)((()=>(0,a.invokeAlertEditorWithOnlineSeries)(d)),h);(0,i.isLineTool)(g)&&g.canHasAlert()?g.hasAlert().value()?(0,s.runOrSigninWithFeature)((()=>g.editAlert(c)),h):(d.drawing=g,(0,s.runOrSigninWithFeature)((()=>(0,a.invokeAlertEditorWithOnlineSeries)(d)),h)):(0,s.runOrSigninWithFeature)((()=>(0,a.invokeAlertEditorWithOnlineSeries)(d)),h)}({dataSourceHub:r,analyticsData:{actionSource:"hotkey",featureLocation:"hotkey",goProSource:"Alerts create hotkey",goProSourceMeta:"Chart"}})}})}}}]);